<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Martes: Identificaci√≥n de Peligros y Riesgos</title>
    <style>
        body {
            box-sizing: border-box;
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            margin: 0;
            padding: 0;
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 50%, #4facfe 100%);
            min-height: 100%;
            color: #2d3748;
            line-height: 1.8;
            font-size: 16px;
        }

        html {
            height: 100%;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            background: rgba(255, 255, 255, 0.98);
            backdrop-filter: blur(25px);
            border-radius: 28px;
            padding: 50px 40px;
            margin-bottom: 40px;
            text-align: center;
            box-shadow: 0 25px 50px rgba(0,0,0,0.08);
            border: 2px solid rgba(255,255,255,0.3);
        }

        .header h1 {
            font-size: 3.5rem;
            font-weight: 700;
            background: linear-gradient(135deg, #f093fb, #f5576c, #4facfe);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin: 0 0 25px 0;
            letter-spacing: -0.01em;
            line-height: 1.2;
        }

        .header .subtitle {
            font-size: 1.4rem;
            color: #5a6c7d;
            margin: 0 0 30px 0;
            font-weight: 400;
            line-height: 1.6;
        }

        .progress-container {
            background: #e2e8f0;
            height: 8px;
            border-radius: 4px;
            overflow: hidden;
            margin-top: 20px;
        }

        .progress-bar {
            background: linear-gradient(90deg, #667eea, #764ba2);
            height: 100%;
            width: 100%;
            border-radius: 4px;
            animation: progressFill 2s ease-out;
        }

        @keyframes progressFill {
            from { width: 0%; }
            to { width: 100%; }
        }

        /* Barra superior horizontal */
        .top-bar {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 30px;
        }

        .timer-card {
            background: linear-gradient(135deg, #ff6b6b, #ee5a24, #fd79a8);
            color: white;
            padding: 30px;
            border-radius: 28px;
            text-align: center;
            box-shadow: 0 20px 40px rgba(255,107,107,0.3);
            border: 3px solid rgba(255,255,255,0.2);
        }

        .timer-card h3 {
            font-size: 1.4rem;
            margin-bottom: 10px;
            font-weight: 600;
        }

        .timer-card p {
            font-size: 1rem;
            opacity: 0.9;
            margin-bottom: 20px;
            line-height: 1.6;
        }

        .timer-display {
            font-size: 3rem;
            font-weight: 800;
            margin: 15px 0;
            font-family: 'SF Mono', Monaco, 'Courier New', monospace;
            text-shadow: 0 2px 10px rgba(0,0,0,0.3);
        }

        .start-btn {
            background: rgba(255,255,255,0.25);
            border: 2px solid rgba(255,255,255,0.4);
            color: white;
            padding: 15px 30px;
            border-radius: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            backdrop-filter: blur(15px);
            font-size: 1.05rem;
        }

        .start-btn:hover {
            background: rgba(255,255,255,0.35);
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(0,0,0,0.2);
        }

        .module-nav {
            background: rgba(255, 255, 255, 0.98);
            backdrop-filter: blur(25px);
            border-radius: 28px;
            padding: 30px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.08);
            border: 2px solid rgba(255,255,255,0.3);
        }

        .module-nav h4 {
            font-size: 1.3rem;
            margin-bottom: 20px;
            color: #1a202c;
            font-weight: 700;
            text-align: center;
        }

        .nav-grid {
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            gap: 10px;
        }

        .module-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 15px 10px;
            border-radius: 16px;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 2px solid transparent;
            background: rgba(248,250,252,0.5);
            text-align: center;
        }

        .module-item:hover {
            background: rgba(240,147,251,0.1);
            border-color: #f093fb;
            transform: translateY(-3px);
        }

        .module-item.active {
            background: linear-gradient(135deg, #f093fb, #f5576c, #4facfe);
            color: white;
            box-shadow: 0 10px 25px rgba(240,147,251,0.3);
        }

        .module-icon {
            font-size: 1.5rem;
            margin-bottom: 8px;
        }

        .module-title {
            font-weight: 600;
            font-size: 0.85rem;
            line-height: 1.2;
        }

        .lesson-grid {
            display: grid;
            grid-template-columns: 1fr;
            gap: 30px;
            margin-bottom: 30px;
        }

        .main-content {
            background: rgba(255, 255, 255, 0.98);
            backdrop-filter: blur(25px);
            border-radius: 28px;
            padding: 50px;
            box-shadow: 0 25px 50px rgba(0,0,0,0.08);
            border: 2px solid rgba(255,255,255,0.3);
            position: relative;
            min-height: 700px;
        }

        .story-page {
            display: none;
            animation: fadeIn 0.5s ease-in-out;
        }

        .story-page.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .page-navigation {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: 40px;
            padding-top: 30px;
            border-top: 2px solid #e2e8f0;
        }

        .nav-btn {
            background: linear-gradient(135deg, #f093fb, #f5576c, #4facfe);
            color: white;
            border: none;
            padding: 18px 35px;
            border-radius: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 1.1rem;
            box-shadow: 0 8px 20px rgba(240,147,251,0.3);
        }

        .nav-btn:hover:not(:disabled) {
            transform: translateY(-3px);
            box-shadow: 0 15px 35px rgba(240,147,251,0.4);
            filter: brightness(1.1);
        }

        .nav-btn:disabled {
            background: linear-gradient(135deg, #cbd5e0, #a0aec0);
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }

        .page-indicators {
            display: flex;
            gap: 10px;
        }

        .page-dot {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: #cbd5e0;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .page-dot.active {
            background: linear-gradient(135deg, #667eea, #764ba2);
            transform: scale(1.2);
        }

        .story-header {
            text-align: center;
            margin-bottom: 50px;
            padding: 40px;
            background: linear-gradient(135deg, #f8fafc, #e2e8f0);
            border-radius: 24px;
            border: 3px solid transparent;
            background-clip: padding-box;
            position: relative;
        }

        .story-header::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(135deg, #f093fb, #f5576c, #4facfe);
            border-radius: 24px;
            padding: 3px;
            mask: linear-gradient(#fff 0 0) content-box, linear-gradient(#fff 0 0);
            mask-composite: exclude;
            z-index: -1;
        }

        .story-title {
            font-size: 3rem;
            font-weight: 700;
            color: #1a202c;
            margin-bottom: 20px;
            line-height: 1.3;
        }

        .story-subtitle {
            font-size: 1.3rem;
            color: #4a5568;
            font-style: italic;
            font-weight: 400;
            line-height: 1.6;
        }

        .character-intro {
            display: flex;
            align-items: center;
            background: linear-gradient(135deg, #ffffff, #f8fafc);
            padding: 35px;
            border-radius: 24px;
            margin: 40px 0;
            box-shadow: 0 15px 35px rgba(0,0,0,0.08);
            border: 2px solid rgba(240,147,251,0.1);
        }

        .character-avatar {
            width: 100px;
            height: 100px;
            border-radius: 50%;
            background: linear-gradient(135deg, #f093fb, #f5576c);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 3rem;
            margin-right: 30px;
            flex-shrink: 0;
            box-shadow: 0 10px 25px rgba(240,147,251,0.3);
        }

        .character-info h3 {
            margin: 0 0 15px 0;
            color: #1a202c;
            font-size: 1.6rem;
            font-weight: 600;
        }

        .character-info p {
            margin: 0;
            color: #4a5568;
            line-height: 1.8;
            font-size: 1.05rem;
        }

        .story-content {
            font-size: 1.15rem;
            line-height: 2;
            color: #2d3748;
            text-align: justify;
        }

        .story-content p {
            margin-bottom: 30px;
            text-indent: 2em;
        }

        .story-content p:first-of-type {
            text-indent: 0;
            font-size: 1.2rem;
            font-weight: 500;
        }

        .quote-box {
            background: linear-gradient(135deg, #e6fffa, #f0fff4);
            border: 3px solid transparent;
            background-clip: padding-box;
            padding: 35px;
            margin: 40px 0;
            border-radius: 20px;
            font-style: italic;
            font-size: 1.2rem;
            color: #2d3748;
            position: relative;
            text-align: center;
            line-height: 1.8;
        }

        .quote-box::before {
            content: '"';
            position: absolute;
            top: -10px;
            left: 20px;
            font-size: 4rem;
            color: #48bb78;
            font-family: serif;
        }

        .quote-box::after {
            content: '"';
            position: absolute;
            bottom: -30px;
            right: 20px;
            font-size: 4rem;
            color: #48bb78;
            font-family: serif;
        }

        .eureka-moment {
            background: linear-gradient(135deg, #fff7ed, #fed7aa);
            border: 3px solid #f6ad55;
            padding: 35px;
            border-radius: 24px;
            margin: 40px 0;
            text-align: center;
            box-shadow: 0 15px 35px rgba(246,173,85,0.2);
            position: relative;
            overflow: hidden;
        }

        .eureka-moment::before {
            content: '‚ú®';
            position: absolute;
            top: 15px;
            right: 20px;
            font-size: 2rem;
            animation: sparkle 2s infinite;
        }

        @keyframes sparkle {
            0%, 100% { transform: scale(1) rotate(0deg); }
            50% { transform: scale(1.2) rotate(180deg); }
        }

        .eureka-moment h4 {
            color: #c05621;
            font-size: 1.4rem;
            margin-bottom: 20px;
            font-weight: 600;
        }

        .eureka-moment p {
            font-size: 1.1rem;
            line-height: 1.8;
            margin: 0;
        }

        .learning-objectives {
            background: linear-gradient(135deg, #ffffff, #f8fafc);
            padding: 40px;
            border-radius: 24px;
            margin: 40px 0;
            box-shadow: 0 15px 35px rgba(0,0,0,0.08);
            border: 2px solid rgba(79,172,254,0.1);
        }

        .learning-objectives h4 {
            color: #4facfe;
            margin-bottom: 30px;
            font-size: 1.5rem;
            font-weight: 600;
            text-align: center;
        }

        .learning-objectives ul {
            list-style: none;
            padding: 0;
            margin: 0;
        }

        .learning-objectives li {
            padding: 20px 0;
            border-bottom: 2px solid #e2e8f0;
            color: #4a5568;
            font-size: 1.1rem;
            line-height: 1.8;
            transition: all 0.3s ease;
        }

        .learning-objectives li:hover {
            background: rgba(79,172,254,0.05);
            padding-left: 20px;
            border-radius: 12px;
        }

        .learning-objectives li:last-child {
            border-bottom: none;
        }

        .learning-objectives li::before {
            content: 'üéØ';
            margin-right: 15px;
            font-size: 1.2rem;
        }

        .definition-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 25px;
            margin: 40px 0;
        }

        .concept-card {
            background: linear-gradient(135deg, #ffffff, #f8fafc);
            border-radius: 20px;
            padding: 0;
            box-shadow: 0 15px 35px rgba(0,0,0,0.12);
            border: 3px solid transparent;
            transition: all 0.3s ease;
            overflow: hidden;
        }

        .concept-card:hover {
            transform: translateY(-8px);
            box-shadow: 0 25px 50px rgba(0,0,0,0.15);
            border-color: rgba(102,126,234,0.3);
        }

        .concept-header {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            padding: 20px 25px;
            text-align: center;
            position: relative;
            overflow: hidden;
        }

        .concept-header::before {
            content: '';
            position: absolute;
            top: -50%;
            right: -50%;
            width: 100%;
            height: 100%;
            background: radial-gradient(circle, rgba(255,255,255,0.1) 0%, transparent 70%);
            transform: rotate(45deg);
        }

        .concept-content {
            padding: 25px;
            text-align: left;
        }

        .expand-btn {
            background: linear-gradient(135deg, #4facfe, #00f2fe);
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 12px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            margin: 15px 0;
            font-size: 0.9rem;
            box-shadow: 0 4px 15px rgba(79,172,254,0.3);
        }

        .expand-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(79,172,254,0.4);
        }

        .expandable-content {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.5s ease-out;
            background: rgba(79,172,254,0.05);
            border-radius: 12px;
            margin: 10px 0;
        }

        .expandable-content.expanded {
            max-height: 1000px;
            padding: 20px;
        }

        .methodology-cards {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 25px;
            margin: 30px 0;
        }

        .methodology-card {
            background: white;
            border-radius: 16px;
            padding: 30px;
            box-shadow: 0 15px 35px rgba(0,0,0,0.1);
            border: 2px solid transparent;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .methodology-card:hover {
            border-color: #667eea;
            transform: translateY(-8px);
            box-shadow: 0 25px 50px rgba(0,0,0,0.15);
        }

        .methodology-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 6px;
            background: linear-gradient(90deg, #667eea, #764ba2);
        }

        .methodology-header {
            display: flex;
            align-items: center;
            margin-bottom: 20px;
        }

        .methodology-icon {
            font-size: 2.5rem;
            margin-right: 15px;
        }

        .methodology-name {
            font-size: 1.4rem;
            font-weight: 700;
            color: #2d3748;
        }

        .methodology-description {
            color: #4a5568;
            font-size: 0.95rem;
            line-height: 1.6;
            margin-bottom: 20px;
        }

        .methodology-features {
            list-style: none;
            padding: 0;
            margin: 0;
        }

        .methodology-features li {
            padding: 8px 0;
            border-bottom: 1px solid #e2e8f0;
            color: #4a5568;
            font-size: 0.9rem;
        }

        .methodology-features li:last-child {
            border-bottom: none;
        }

        .methodology-features li::before {
            content: '‚úì';
            color: #48bb78;
            font-weight: bold;
            margin-right: 10px;
        }

        /* Modal Styles */
        .modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.8);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            backdrop-filter: blur(5px);
        }

        .modal-container {
            background: white;
            border-radius: 20px;
            padding: 40px;
            max-width: 1200px;
            max-height: 90%;
            overflow-y: auto;
            position: relative;
            box-shadow: 0 25px 50px rgba(0,0,0,0.3);
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 2px solid #e2e8f0;
        }

        .close-btn {
            background: #e53e3e;
            color: white;
            border: none;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            cursor: pointer;
            font-size: 1.2rem;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .workshop-step {
            background: linear-gradient(135deg, #f8fafc, #edf2f7);
            border-radius: 16px;
            padding: 30px;
            margin: 25px 0;
            border-left: 6px solid #667eea;
            position: relative;
        }

        .step-number {
            position: absolute;
            top: -15px;
            left: 20px;
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 1.2rem;
        }

        .step-title {
            font-size: 1.5rem;
            font-weight: 700;
            color: #667eea;
            margin: 0 0 15px 0;
            padding-left: 20px;
        }

        .step-content {
            color: #4a5568;
            line-height: 1.8;
            margin-bottom: 20px;
        }

        .ai-workshop-tool {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            border-radius: 20px;
            padding: 30px;
            margin: 20px 0;
        }

        .workshop-input {
            width: 100%;
            padding: 12px;
            border: 2px solid rgba(255,255,255,0.3);
            border-radius: 8px;
            background: rgba(255,255,255,0.2);
            color: white;
            font-size: 0.9rem;
            backdrop-filter: blur(10px);
            margin-bottom: 15px;
        }

        .workshop-input::placeholder {
            color: rgba(255,255,255,0.7);
        }

        .workshop-btn {
            background: rgba(255,255,255,0.2);
            border: 2px solid rgba(255,255,255,0.4);
            color: white;
            padding: 12px 25px;
            border-radius: 10px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            backdrop-filter: blur(15px);
            margin: 10px 5px;
        }

        .workshop-btn:hover {
            background: rgba(255,255,255,0.3);
            transform: translateY(-2px);
        }

        .workshop-result {
            background: rgba(255,255,255,0.15);
            padding: 20px;
            border-radius: 12px;
            margin-top: 20px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255,255,255,0.2);
        }

        .horizontal-nav-item {
            background: rgba(255,255,255,0.2);
            border: 2px solid rgba(255,255,255,0.3);
            color: #4a5568;
            padding: 12px 20px;
            border-radius: 25px;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            backdrop-filter: blur(15px);
            font-size: 0.9rem;
            white-space: nowrap;
        }

        .horizontal-nav-item:hover {
            background: rgba(255,255,255,0.3);
            border-color: rgba(240,147,251,0.5);
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(240,147,251,0.2);
        }

        .horizontal-nav-item.active {
            background: linear-gradient(135deg, #f093fb, #f5576c, #4facfe);
            color: white;
            border-color: transparent;
            box-shadow: 0 8px 25px rgba(240,147,251,0.3);
        }

        @media (max-width: 1024px) {
            .top-bar {
                grid-template-columns: 1fr;
            }
            
            .nav-grid {
                grid-template-columns: repeat(3, 1fr);
                gap: 8px;
            }
            
            .module-item {
                padding: 10px 5px;
            }
            
            .module-title {
                font-size: 0.75rem;
            }
        }

        @media (max-width: 768px) {
            .container {
                padding: 15px;
            }
            
            .header {
                padding: 30px 20px;
            }
            
            .header h1 {
                font-size: 2.5rem;
            }
            
            .main-content {
                padding: 30px 20px;
            }
            
            .story-title {
                font-size: 2rem;
            }

            .flip-card {
                height: 200px;
            }

            .horizontal-nav-item {
                padding: 10px 15px;
                font-size: 0.8rem;
            }

            .nav-grid {
                grid-template-columns: repeat(2, 1fr);
            }

            .module-title {
                font-size: 0.7rem;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header class="header">
            <h1>üîç Identificaci√≥n de Peligros y Riesgos</h1>
            <p class="subtitle">Martes - Semana 1: Metodolog√≠a Sistem√°tica de Identificaci√≥n</p>
            
            <!-- Men√∫ horizontal de navegaci√≥n -->
            <div style="display: flex; justify-content: center; gap: 15px; margin: 25px 0; flex-wrap: wrap;">
                <div class="horizontal-nav-item active" onclick="goToPage(1)" data-page="1">
                    <span style="font-size: 1.2rem; margin-right: 8px;">üåÖ</span>
                    <span style="font-weight: 600; font-size: 0.9rem;">El Despertar</span>
                </div>
                <div class="horizontal-nav-item" onclick="goToPage(2)" data-page="2">
                    <span style="font-size: 1.2rem; margin-right: 8px;">üìö</span>
                    <span style="font-weight: 600; font-size: 0.9rem;">Fundamentos</span>
                </div>
                <div class="horizontal-nav-item" onclick="goToPage(3)" data-page="3">
                    <span style="font-size: 1.2rem; margin-right: 8px;">üõ†Ô∏è</span>
                    <span style="font-weight: 600; font-size: 0.9rem;">Herramientas</span>
                </div>
                <div class="horizontal-nav-item" onclick="goToPage(4)" data-page="4">
                    <span style="font-size: 1.2rem; margin-right: 8px;">üéÄ</span>
                    <span style="font-weight: 600; font-size: 0.9rem;">El Corbat√≠n</span>
                </div>
                <div class="horizontal-nav-item" onclick="goToPage(5)" data-page="5">
                    <span style="font-size: 1.2rem; margin-right: 8px;">üöÄ</span>
                    <span style="font-weight: 600; font-size: 0.9rem;">Pr√°ctica</span>
                </div>
            </div>
            
            <div class="progress-container">
                <div class="progress-bar"></div>
            </div>
        </header>



        <div class="lesson-grid">
            <main class="main-content">
                <!-- P√°gina 1: El Despertar -->
                <div id="page1" class="story-page active">
                    <div class="story-header">
                        <h2 class="story-title">üåÖ El Despertar</h2>
                        <p class="story-subtitle">Cap√≠tulo 1: Cuando Ana descubri√≥ la importancia de la gesti√≥n de riesgos</p>
                    </div>

                    <div class="character-intro">
                        <div class="character-avatar">üë©‚Äçüíº</div>
                        <div class="character-info">
                            <h3>Ana Rodr√≠guez</h3>
                            <p>Ingeniera de Seguridad Vial con 8 a√±os de experiencia. Reci√©n promovida como Jefa de Gesti√≥n de Riesgos en TransLog√≠stica S.A., una empresa de transporte de carga con m√°s de 200 veh√≠culos operando en rutas nacionales e internacionales.</p>
                        </div>
                    </div>

                    <div class="story-content">
                        <p>Era un martes lluvioso cuando Ana recibi√≥ la llamada que cambiar√≠a su perspectiva para siempre. El Director General la convoc√≥ urgentemente a su oficina. Al entrar, encontr√≥ un ambiente tenso: reportes esparcidos sobre el escritorio, gr√°ficos con tendencias alarmantes y la expresi√≥n preocupada de todo el equipo directivo.</p>

                        <div class="quote-box">
                            "Ana, necesitamos tu experiencia m√°s que nunca. Los incidentes viales han aumentado un 35% este trimestre. Nuestros costos de seguros se han disparado y, lo m√°s importante, la seguridad de nuestros conductores est√° en riesgo. Necesitamos un sistema robusto de identificaci√≥n y gesti√≥n de riesgos."
                        </div>

                        <p>Mientras revisaba los datos, Ana se dio cuenta de que la empresa hab√≠a estado operando de manera reactiva, respondiendo a los accidentes despu√©s de que ocurr√≠an, pero sin un sistema proactivo para identificar y prevenir los riesgos antes de que se materializaran.</p>

                        <div class="eureka-moment">
                            <h4>üí° Momento Eureka</h4>
                            <p>"No podemos seguir jugando a la ruleta rusa con la seguridad. Necesitamos anticiparnos, identificar sistem√°ticamente los peligros y evaluar los riesgos antes de que se conviertan en tragedias."</p>
                        </div>

                        <p>Esa noche, Ana se qued√≥ hasta tarde investigando metodolog√≠as internacionales de gesti√≥n de riesgos viales. Descubri√≥ que empresas l√≠deres en el mundo utilizaban marcos sistem√°ticos como el Road Risk Toolkit, las pr√°cticas IOGP 365, y evaluaciones r√°pidas PAHO para transformar su gesti√≥n de seguridad.</p>
                    </div>

                    <div class="learning-objectives">
                        <h4>üéØ Lo que aprender√°s en este cap√≠tulo:</h4>
                        <ul>
                            <li>La importancia de la gesti√≥n proactiva vs reactiva de riesgos</li>
                            <li>El impacto econ√≥mico y humano de los accidentes viales</li>
                            <li>La necesidad de sistemas estructurados de identificaci√≥n de riesgos</li>
                            <li>El rol del liderazgo en la cultura de seguridad</li>
                        </ul>
                    </div>
                </div>

                <!-- P√°gina 2: Los Fundamentos -->
                <div id="page2" class="story-page">
                    <div class="story-header">
                        <h2 class="story-title">üìö Los Fundamentos</h2>
                        <p class="story-subtitle">Cap√≠tulo 2: Ana descubre los conceptos clave</p>
                    </div>

                    <div class="story-content">
                        <p>Al d√≠a siguiente, Ana convoc√≥ a su equipo para una sesi√≥n de capacitaci√≥n intensiva. Hab√≠a preparado una presentaci√≥n que cambiar√≠a la forma en que todos entend√≠an la seguridad vial. Comenz√≥ con una pregunta simple pero poderosa:</p>

                        <div class="quote-box">
                            "¬øCu√°l es la diferencia entre un peligro y un riesgo? Esta distinci√≥n puede salvar vidas."
                        </div>

                        <p>Ana explic√≥ que durante a√±os hab√≠an confundido estos conceptos fundamentales, lo que hab√≠a llevado a enfoques ineficaces en su gesti√≥n de seguridad.</p>
                    </div>

                    <div class="definition-grid">
                        <div class="concept-card">
                            <div class="concept-header">
                                <h4 style="color: #e53e3e; margin: 0; font-size: 1.4rem; font-weight: 700;">üö® PELIGRO</h4>
                            </div>
                            <div class="concept-content">
                                <p style="color: #2d3748; line-height: 1.8; margin-bottom: 15px;">Ana mostr√≥ una foto de la intersecci√≥n del Km 45 de la Ruta Nacional 9: <strong>"Este cruce sin sem√°foro es un PELIGRO. Es una fuente con potencial de causar da√±o. Existe independientemente de si pasa o no un veh√≠culo."</strong></p>
                                <div style="background: #e6fffa; padding: 15px; border-radius: 8px; margin-top: 15px; border-left: 4px solid #4facfe;">
                                    <p style="margin: 0; color: #2d3748; font-size: 0.9rem;"><strong>üí° Recuerda:</strong> Un peligro existe independientemente de si hay exposici√≥n o no. Es una condici√≥n o situaci√≥n con potencial de causar da√±o.</p>
                                </div>
                            </div>
                        </div>
                        
                        <div class="concept-card">
                            <div class="concept-header">
                                <h4 style="color: #d69e2e; margin: 0; font-size: 1.4rem; font-weight: 700;">‚öñÔ∏è RIESGO</h4>
                            </div>
                            <div class="concept-content">
                                <p style="color: #2d3748; line-height: 1.8; margin-bottom: 15px;"><strong>"El RIESGO surge cuando nuestros conductores transitan por esa intersecci√≥n. Es la combinaci√≥n de la probabilidad de que ocurra un accidente y la severidad de las consecuencias."</strong></p>
                                <div style="background: #fff3cd; padding: 25px; border-radius: 12px; text-align: center; color: #856404; margin-bottom: 20px;">
                                    <h4 style="margin: 0 0 15px 0; font-size: 1.4rem;">RIESGO = PROBABILIDAD √ó SEVERIDAD √ó EXPOSICI√ìN</h4>
                                    <p style="margin: 0; font-size: 1rem; font-weight: 600;">Donde cada factor se eval√∫a en una escala de 1 a 5</p>
                                </div>
                                <div style="background: #f3e5f5; padding: 15px; border-radius: 8px; margin-top: 15px; border-left: 4px solid #9c27b0;">
                                    <p style="margin: 0; color: #2d3748; font-size: 0.9rem;"><strong>üìä Ejemplo de C√°lculo:</strong> Intersecci√≥n peligrosa con Probabilidad=4, Severidad=4, Exposici√≥n=5 ‚Üí Riesgo = 4√ó4√ó5 = 80 (Riesgo Alto)</p>
                                </div>
                            </div>
                        </div>
                        
                        <div class="concept-card">
                            <div class="concept-header">
                                <h4 style="color: #4facfe; margin: 0; font-size: 1.4rem; font-weight: 700;">üìä EXPOSICI√ìN</h4>
                            </div>
                            <div class="concept-content">
                                <p style="color: #2d3748; line-height: 1.8; margin-bottom: 15px;"><strong>"Nuestros camiones pasan por esa intersecci√≥n 15 veces al d√≠a, 6 d√≠as a la semana. Esa EXPOSICI√ìN multiplica el riesgo. A mayor exposici√≥n, mayor probabilidad de materializaci√≥n del riesgo."</strong></p>
                                <div style="background: #e3f2fd; padding: 20px; border-radius: 12px; color: #1565c0; margin-bottom: 15px;">
                                    <h6 style="margin: 0 0 15px 0; color: #0d47a1;">üöõ Ejemplo TransLog√≠stica - Ruta Cr√≠tica:</h6>
                                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
                                        <div>
                                            <p style="margin: 0 0 8px 0;"><strong>Tr√°nsitos Diarios:</strong> 15 veh√≠culos</p>
                                            <p style="margin: 0 0 8px 0;"><strong>D√≠as Operativos:</strong> 6 d√≠as/semana</p>
                                        </div>
                                        <div>
                                            <p style="margin: 0 0 8px 0;"><strong>Semanal:</strong> 90 tr√°nsitos</p>
                                            <p style="margin: 0 0 8px 0;"><strong>Anual:</strong> 4,680 tr√°nsitos</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="concept-card">
                            <div class="concept-header">
                                <h4 style="color: #48bb78; margin: 0; font-size: 1.4rem; font-weight: 700;">üõ°Ô∏è VULNERABILIDAD</h4>
                            </div>
                            <div class="concept-content">
                                <p style="color: #2d3748; line-height: 1.8; margin-bottom: 15px;"><strong>"Un conductor novato en un cami√≥n cargado con materiales peligrosos tiene mayor VULNERABILIDAD que un conductor experimentado en un veh√≠culo liviano. La vulnerabilidad amplifica las consecuencias."</strong></p>
                                <div style="background: #e8f5e8; padding: 20px; border-radius: 12px; border-left: 4px solid #4caf50;">
                                    <h6 style="color: #2e7d32; margin: 0 0 15px 0;">üéØ Factores Clave:</h6>
                                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
                                        <div><strong>üë§ Factor Humano:</strong> Experiencia, salud, capacitaci√≥n</div>
                                        <div><strong>üöõ Factor Vehicular:</strong> Tipo de carga, estado, sistemas de seguridad</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Secci√≥n de Ejemplos Detallados -->
                    <div style="background: linear-gradient(135deg, #f8fafc, #edf2f7); padding: 40px; border-radius: 24px; margin: 40px 0; border: 2px solid rgba(102,126,234,0.1);">
                        <h3 style="text-align: center; color: #667eea; margin-bottom: 30px; font-size: 1.8rem;">üìö Ejemplos Detallados y Escalas de Evaluaci√≥n</h3>
                        
                        <!-- Ejemplos de Peligros -->
                        <div style="background: #ffffff; padding: 30px; border-radius: 16px; margin-bottom: 30px; box-shadow: 0 4px 15px rgba(0,0,0,0.08);">
                            <h4 style="color: #e53e3e; margin-bottom: 20px; display: flex; align-items: center;"><span style="margin-right: 10px;">üö®</span> Ejemplos de Peligros Viales</h4>
                            <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 20px;">
                                <div style="background: #fff5f5; padding: 20px; border-radius: 12px; border-left: 4px solid #e53e3e;">
                                    <h5 style="color: #c53030; margin: 0 0 15px 0;">üõ£Ô∏è Peligros de Infraestructura</h5>
                                    <ul style="list-style: none; padding: 0; margin: 0;">
                                        <li style="padding: 8px 0; border-bottom: 1px solid #fed7d7; font-size: 0.95rem;">‚Ä¢ Intersecciones sin se√±alizaci√≥n</li>
                                        <li style="padding: 8px 0; border-bottom: 1px solid #fed7d7; font-size: 0.95rem;">‚Ä¢ Curvas con visibilidad limitada</li>
                                        <li style="padding: 8px 0; border-bottom: 1px solid #fed7d7; font-size: 0.95rem;">‚Ä¢ Pendientes pronunciadas</li>
                                        <li style="padding: 8px 0; font-size: 0.95rem;">‚Ä¢ Puentes en mal estado</li>
                                    </ul>
                                </div>
                                <div style="background: #fff5f5; padding: 20px; border-radius: 12px; border-left: 4px solid #e53e3e;">
                                    <h5 style="color: #c53030; margin: 0 0 15px 0;">üåßÔ∏è Peligros Ambientales</h5>
                                    <ul style="list-style: none; padding: 0; margin: 0;">
                                        <li style="padding: 8px 0; border-bottom: 1px solid #fed7d7; font-size: 0.95rem;">‚Ä¢ Pavimento resbaladizo</li>
                                        <li style="padding: 8px 0; border-bottom: 1px solid #fed7d7; font-size: 0.95rem;">‚Ä¢ Zonas de construcci√≥n</li>
                                        <li style="padding: 8px 0; border-bottom: 1px solid #fed7d7; font-size: 0.95rem;">‚Ä¢ Neblina densa</li>
                                        <li style="padding: 8px 0; font-size: 0.95rem;">‚Ä¢ Animales en la v√≠a</li>
                                    </ul>
                                </div>
                            </div>
                        </div>

                        <!-- Escalas de Evaluaci√≥n -->
                        <div style="background: #ffffff; padding: 30px; border-radius: 16px; margin-bottom: 30px; box-shadow: 0 4px 15px rgba(0,0,0,0.08);">
                            <h4 style="color: #d69e2e; margin-bottom: 20px; display: flex; align-items: center;"><span style="margin-right: 10px;">‚öñÔ∏è</span> Escalas de Evaluaci√≥n de Riesgo</h4>
                            <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 20px;">
                                <div style="background: #e3f2fd; padding: 20px; border-radius: 12px; text-align: center;">
                                    <h5 style="color: #1565c0; margin: 0 0 15px 0;">üìà PROBABILIDAD</h5>
                                    <div style="font-size: 0.9rem; color: #424242; text-align: left;">
                                        <div style="margin: 6px 0; padding: 8px; background: #ffffff; border-radius: 4px;">1 = Muy improbable</div>
                                        <div style="margin: 6px 0; padding: 8px; background: #ffffff; border-radius: 4px;">2 = Improbable</div>
                                        <div style="margin: 6px 0; padding: 8px; background: #ffffff; border-radius: 4px;">3 = Posible</div>
                                        <div style="margin: 6px 0; padding: 8px; background: #ffffff; border-radius: 4px;">4 = Probable</div>
                                        <div style="margin: 6px 0; padding: 8px; background: #ffffff; border-radius: 4px;">5 = Muy probable</div>
                                    </div>
                                </div>
                                <div style="background: #ffebee; padding: 20px; border-radius: 12px; text-align: center;">
                                    <h5 style="color: #c62828; margin: 0 0 15px 0;">üí• SEVERIDAD</h5>
                                    <div style="font-size: 0.9rem; color: #424242; text-align: left;">
                                        <div style="margin: 6px 0; padding: 8px; background: #ffffff; border-radius: 4px;">1 = Insignificante</div>
                                        <div style="margin: 6px 0; padding: 8px; background: #ffffff; border-radius: 4px;">2 = Menor</div>
                                        <div style="margin: 6px 0; padding: 8px; background: #ffffff; border-radius: 4px;">3 = Moderada</div>
                                        <div style="margin: 6px 0; padding: 8px; background: #ffffff; border-radius: 4px;">4 = Mayor</div>
                                        <div style="margin: 6px 0; padding: 8px; background: #ffffff; border-radius: 4px;">5 = Catastr√≥fica</div>
                                    </div>
                                </div>
                                <div style="background: #fff3e0; padding: 20px; border-radius: 12px; text-align: center;">
                                    <h5 style="color: #ef6c00; margin: 0 0 15px 0;">üë• EXPOSICI√ìN</h5>
                                    <div style="font-size: 0.9rem; color: #424242; text-align: left;">
                                        <div style="margin: 6px 0; padding: 8px; background: #ffffff; border-radius: 4px;">1 = Muy rara (< 100/a√±o)</div>
                                        <div style="margin: 6px 0; padding: 8px; background: #ffffff; border-radius: 4px;">2 = Rara (100-500/a√±o)</div>
                                        <div style="margin: 6px 0; padding: 8px; background: #ffffff; border-radius: 4px;">3 = Ocasional (500-2K/a√±o)</div>
                                        <div style="margin: 6px 0; padding: 8px; background: #ffffff; border-radius: 4px;">4 = Frecuente (2K-5K/a√±o)</div>
                                        <div style="margin: 6px 0; padding: 8px; background: #ffffff; border-radius: 4px;">5 = Continua (> 5K/a√±o)</div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Matriz de Vulnerabilidad -->
                        <div style="background: #ffffff; padding: 30px; border-radius: 16px; box-shadow: 0 4px 15px rgba(0,0,0,0.08);">
                            <h4 style="color: #48bb78; margin-bottom: 20px; display: flex; align-items: center;"><span style="margin-right: 10px;">üõ°Ô∏è</span> Matriz de Vulnerabilidad TransLog√≠stica</h4>
                            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 25px; margin-bottom: 20px;">
                                <div style="background: #f1f8e9; padding: 20px; border-radius: 12px;">
                                    <h5 style="color: #2e7d32; margin: 0 0 15px 0; display: flex; align-items: center;"><span style="margin-right: 8px;">üë§</span> Factor Humano</h5>
                                    <div style="background: #ffffff; padding: 12px; border-radius: 8px; margin-bottom: 10px;">
                                        <strong style="color: #2e7d32;">Experiencia:</strong> Novato vs Experto
                                    </div>
                                    <div style="background: #ffffff; padding: 12px; border-radius: 8px; margin-bottom: 10px;">
                                        <strong style="color: #2e7d32;">Estado de salud:</strong> Fatiga, estr√©s, condiciones m√©dicas
                                    </div>
                                    <div style="background: #ffffff; padding: 12px; border-radius: 8px;">
                                        <strong style="color: #2e7d32;">Capacitaci√≥n:</strong> Cursos de seguridad y manejo defensivo
                                    </div>
                                </div>
                                <div style="background: #f1f8e9; padding: 20px; border-radius: 12px;">
                                    <h5 style="color: #2e7d32; margin: 0 0 15px 0; display: flex; align-items: center;"><span style="margin-right: 8px;">üöõ</span> Factor Vehicular</h5>
                                    <div style="background: #ffffff; padding: 12px; border-radius: 8px; margin-bottom: 10px;">
                                        <strong style="color: #2e7d32;">Tipo de carga:</strong> Materiales peligrosos vs carga general
                                    </div>
                                    <div style="background: #ffffff; padding: 12px; border-radius: 8px; margin-bottom: 10px;">
                                        <strong style="color: #2e7d32;">Estado del veh√≠culo:</strong> Mantenimiento y antig√ºedad
                                    </div>
                                    <div style="background: #ffffff; padding: 12px; border-radius: 8px;">
                                        <strong style="color: #2e7d32;">Sistemas de seguridad:</strong> ABS, ESP, airbags, alertas
                                    </div>
                                </div>
                            </div>
                            <div style="background: #e8f5e8; padding: 20px; border-radius: 12px;">
                                <h6 style="color: #2e7d32; margin: 0 0 15px 0; text-align: center;">üìä Ejemplos de Evaluaci√≥n</h6>
                                <div style="display: grid; grid-template-columns: repeat(4, 1fr); gap: 8px; font-size: 0.85rem; text-align: center;">
                                    <div style="background: #2e7d32; color: white; padding: 10px; border-radius: 6px; font-weight: bold;">Escenario</div>
                                    <div style="background: #2e7d32; color: white; padding: 10px; border-radius: 6px; font-weight: bold;">Conductor</div>
                                    <div style="background: #2e7d32; color: white; padding: 10px; border-radius: 6px; font-weight: bold;">Veh√≠culo</div>
                                    <div style="background: #2e7d32; color: white; padding: 10px; border-radius: 6px; font-weight: bold;">Vulnerabilidad</div>
                                    
                                    <div style="background: #ffffff; padding: 10px; border-radius: 6px;">Ruta urbana</div>
                                    <div style="background: #ffffff; padding: 10px; border-radius: 6px;">Experto</div>
                                    <div style="background: #ffffff; padding: 10px; border-radius: 6px;">Nuevo</div>
                                    <div style="background: #81c784; color: white; padding: 10px; border-radius: 6px; font-weight: bold;">BAJA</div>
                                    
                                    <div style="background: #ffffff; padding: 10px; border-radius: 6px;">Ruta nocturna</div>
                                    <div style="background: #ffffff; padding: 10px; border-radius: 6px;">Novato</div>
                                    <div style="background: #ffffff; padding: 10px; border-radius: 6px;">Antiguo</div>
                                    <div style="background: #ffb74d; color: white; padding: 10px; border-radius: 6px; font-weight: bold;">ALTA</div>
                                    
                                    <div style="background: #ffffff; padding: 10px; border-radius: 6px;">Carga peligrosa</div>
                                    <div style="background: #ffffff; padding: 10px; border-radius: 6px;">Novato</div>
                                    <div style="background: #ffffff; padding: 10px; border-radius: 6px;">Antiguo</div>
                                    <div style="background: #e57373; color: white; padding: 10px; border-radius: 6px; font-weight: bold;">CR√çTICA</div>
                                </div>
                            </div>
                        </div>
                    </div>


                </div>

                <!-- P√°gina 3: Las Herramientas -->
                <div id="page3" class="story-page">
                    <div class="story-header">
                        <h2 class="story-title">üõ†Ô∏è Las Herramientas</h2>
                        <p class="story-subtitle">Cap√≠tulo 3: Ana descubre las metodolog√≠as internacionales</p>
                    </div>

                    <div class="story-content">
                        <p>Una semana despu√©s, Ana present√≥ al directorio su investigaci√≥n sobre las mejores pr√°cticas internacionales. Hab√≠a identificado cuatro marcos metodol√≥gicos que transformar√≠an completamente su enfoque de gesti√≥n de riesgos.</p>

                        <div class="quote-box">
                            "No necesitamos reinventar la rueda. Las empresas m√°s exitosas del mundo ya han desarrollado marcos probados que podemos adaptar a nuestra realidad."
                        </div>
                    </div>

                    <div class="methodology-cards">
                        <div class="methodology-card">
                            <div class="methodology-header">
                                <span class="methodology-icon">üõ£Ô∏è</span>
                                <h4 class="methodology-name">Road Risk Toolkit</h4>
                            </div>
                            <p class="methodology-description">Ana explic√≥: "Este marco fue desarrollado por expertos internacionales espec√≠ficamente para empresas como la nuestra. Nos da una estructura sistem√°tica para evaluar cada aspecto de nuestras operaciones viales."</p>
                            <ul class="methodology-features">
                                <li>Evaluaci√≥n sistem√°tica de factores de riesgo</li>
                                <li>Herramientas de mapeo y priorizaci√≥n</li>
                                <li>Integraci√≥n con sistemas de gesti√≥n existentes</li>
                                <li>Enfoque basado en evidencia y datos</li>
                            </ul>
                            <div class="eureka-moment" style="margin-top: 15px;">
                                <p style="font-size: 0.9rem; margin: 0 0 15px 0;"><strong>Caso de √©xito:</strong> DHL redujo sus accidentes en un 40% implementando este toolkit en sus operaciones europeas.</p>
                                <a href="https://roadrisktoolkit.com/es/" target="_blank" rel="noopener noreferrer" style="display: inline-block; background: linear-gradient(135deg, #667eea, #764ba2); color: white; padding: 12px 20px; border-radius: 10px; text-decoration: none; font-weight: 600; font-size: 0.9rem; transition: all 0.3s ease; box-shadow: 0 4px 15px rgba(102,126,234,0.3);" onmouseover="this.style.transform='translateY(-2px)'; this.style.boxShadow='0 8px 25px rgba(102,126,234,0.4)'" onmouseout="this.style.transform='translateY(0px)'; this.style.boxShadow='0 4px 15px rgba(102,126,234,0.3)'">
                                    üåê Visitar Road Risk Toolkit
                                </a>
                            </div>
                        </div>
                        
                        <div class="methodology-card">
                            <div class="methodology-header">
                                <span class="methodology-icon">üè≠</span>
                                <h4 class="methodology-name">IOGP 365</h4>
                            </div>
                            <p class="methodology-description">"Las empresas petroleras manejan los riesgos m√°s altos del mundo. Sus pr√°cticas recomendadas para transporte terrestre son el est√°ndar de oro en gesti√≥n de seguridad."</p>
                            <ul class="methodology-features">
                                <li>Est√°ndares de seguridad operacional rigurosos</li>
                                <li>Gesti√≥n integral de conductores y veh√≠culos</li>
                                <li>Procedimientos de emergencia estructurados</li>
                                <li>Sistemas de monitoreo y mejora continua</li>
                            </ul>
                            <div class="eureka-moment" style="margin-top: 15px;">
                                <p style="font-size: 0.9rem; margin: 0 0 15px 0;"><strong>Dato impactante:</strong> Empresas que siguen IOGP 365 tienen tasas de accidentalidad 60% menores que el promedio de la industria.</p>
                                <div style="background: rgba(255,255,255,0.9); padding: 20px; border-radius: 12px; text-align: center;">
                                    <h5 style="color: #2d3748; margin: 0 0 15px 0; font-size: 1rem;">üé• Video Explicativo IOGP 365</h5>
                                    <a href="https://youtu.be/GJGOO17yZ6o?si=jLh8ACJ5jqSUyWyR" target="_blank" rel="noopener noreferrer" style="display: block; background: linear-gradient(135deg, #667eea, #764ba2); color: white; padding: 40px 20px; border-radius: 10px; position: relative; text-decoration: none; transition: all 0.3s ease;" onmouseover="this.style.transform='translateY(-3px)'; this.style.boxShadow='0 15px 35px rgba(102,126,234,0.4)'" onmouseout="this.style.transform='translateY(0px)'; this.style.boxShadow='none'">
                                        <div style="font-size: 3rem; margin-bottom: 10px;">‚ñ∂Ô∏è</div>
                                        <p style="margin: 0; font-weight: 600;">Ver Video IOGP 365</p>
                                        <p style="margin: 5px 0 0 0; font-size: 0.8rem; opacity: 0.8;">Explicaci√≥n detallada en YouTube</p>
                                    </a>
                                </div>
                            </div>
                        </div>
                        
                        <div class="methodology-card">
                            <div class="methodology-header">
                                <span class="methodology-icon">üè•</span>
                                <h4 class="methodology-name">PAHO - Evaluaci√≥n R√°pida</h4>
                            </div>
                            <p class="methodology-description">"La Organizaci√≥n Panamericana de la Salud desarroll√≥ esta metodolog√≠a para evaluaci√≥n r√°pida de riesgos en eventos masivos y transporte. Es especialmente efectiva para an√°lisis inmediatos y toma de decisiones urgentes."</p>
                            <ul class="methodology-features">
                                <li>Evaluaci√≥n r√°pida en situaciones cr√≠ticas</li>
                                <li>Matriz de riesgos simplificada y efectiva</li>
                                <li>Enfoque en salud p√∫blica y seguridad</li>
                                <li>Herramientas de comunicaci√≥n de riesgos</li>
                            </ul>
                            <div class="eureka-moment" style="margin-top: 15px;">
                                <p style="font-size: 0.9rem; margin: 0 0 15px 0;"><strong>Ventaja clave:</strong> Permite evaluaciones de riesgo en menos de 2 horas, ideal para respuesta r√°pida ante emergencias viales.</p>
                                <a href="https://www3.paho.org/hq/dmdocuments/2015/2015-cha-evaluacion-rapida-riesgos-eventos.pdf" target="_blank" rel="noopener noreferrer" style="display: inline-block; background: linear-gradient(135deg, #667eea, #764ba2); color: white; padding: 12px 20px; border-radius: 10px; text-decoration: none; font-weight: 600; font-size: 0.9rem; transition: all 0.3s ease; box-shadow: 0 4px 15px rgba(102,126,234,0.3);" onmouseover="this.style.transform='translateY(-2px)'; this.style.boxShadow='0 8px 25px rgba(102,126,234,0.4)'" onmouseout="this.style.transform='translateY(0px)'; this.style.boxShadow='0 4px 15px rgba(102,126,234,0.3)'">
                                    üìÑ Descargar Gu√≠a PAHO
                                </a>
                            </div>
                        </div>
                        
                        <div class="methodology-card">
                            <div class="methodology-header">
                                <span class="methodology-icon">üèóÔ∏è</span>
                                <h4 class="methodology-name">ISO 39002 - Infraestructura</h4>
                            </div>
                            <p class="methodology-description">"Esta norma internacional establece directrices espec√≠ficas para la gesti√≥n de riesgos en infraestructura vial. Ana la considera fundamental para evaluar riesgos estructurales y de dise√±o en las rutas."</p>
                            <ul class="methodology-features">
                                <li>Gesti√≥n integral de riesgos de infraestructura</li>
                                <li>Evaluaci√≥n de vulnerabilidades estructurales</li>
                                <li>Planificaci√≥n de mantenimiento predictivo</li>
                                <li>Integraci√≥n con sistemas de gesti√≥n de activos</li>
                            </ul>
                            <div class="eureka-moment" style="margin-top: 15px;">
                                <p style="font-size: 0.9rem; margin: 0 0 15px 0;"><strong>Impacto comprobado:</strong> Reduce costos de mantenimiento hasta 30% y extiende vida √∫til de infraestructura vial en 25%.</p>
                                <div style="background: rgba(255,255,255,0.9); padding: 15px; border-radius: 10px; text-align: center;">
                                    <p style="color: #2d3748; margin: 0; font-size: 0.9rem; font-weight: 600;">üìã Norma ISO 39002:2019</p>
                                    <p style="color: #4a5568; margin: 5px 0 10px 0; font-size: 0.8rem;">Gesti√≥n de riesgos - Directrices para infraestructura resiliente</p>
                                    <button onclick="openISO39002Tool()" style="background: linear-gradient(135deg, #667eea, #764ba2); color: white; border: none; padding: 12px 20px; border-radius: 10px; font-weight: 600; cursor: pointer; font-size: 0.9rem; transition: all 0.3s ease; box-shadow: 0 4px 15px rgba(102,126,234,0.3); margin-right: 10px;" onmouseover="this.style.transform='translateY(-2px)'; this.style.boxShadow='0 8px 25px rgba(102,126,234,0.4)'" onmouseout="this.style.transform='translateY(0px)'; this.style.boxShadow='0 4px 15px rgba(102,126,234,0.3)'">
                                        üîß Herramienta ISO 39002
                                    </button>
                                    <button onclick="openISO39002Workshop()" style="background: linear-gradient(135deg, #48bb78, #38a169); color: white; border: none; padding: 12px 20px; border-radius: 10px; font-weight: 600; cursor: pointer; font-size: 0.9rem; transition: all 0.3s ease; box-shadow: 0 4px 15px rgba(72,187,120,0.3);" onmouseover="this.style.transform='translateY(-2px)'; this.style.boxShadow='0 8px 25px rgba(72,187,120,0.4)'" onmouseout="this.style.transform='translateY(0px)'; this.style.boxShadow='0 4px 15px rgba(72,187,120,0.3)'">
                                        üõ†Ô∏è Taller Pr√°ctico
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- P√°gina 4: El Corbat√≠n -->
                <div id="page4" class="story-page">
                    <div class="story-header">
                        <h2 class="story-title">üéÄ El Corbat√≠n</h2>
                        <p class="story-subtitle">Cap√≠tulo 4: Ana descubre el poder del An√°lisis del Corbat√≠n</p>
                    </div>

                    <div class="story-content">
                        <p>Durante su investigaci√≥n, Ana se top√≥ con una metodolog√≠a que cambiar√≠a para siempre su forma de visualizar los riesgos: el An√°lisis del Corbat√≠n o Bowtie Analysis. Al principio, el nombre le pareci√≥ curioso, pero pronto descubri√≥ su poder transformador.</p>

                        <div class="quote-box">
                            "Es como tener rayos X para los riesgos. Puedes ver todo: las causas, el evento central, las consecuencias y, lo m√°s importante, d√≥nde colocar las barreras de protecci√≥n."
                        </div>

                        <p>Ana explic√≥ a su equipo que el An√°lisis del Corbat√≠n es una herramienta visual que permite mapear de manera sistem√°tica todos los elementos de un riesgo, desde sus causas hasta sus consecuencias, identificando las barreras de control necesarias.</p>
                    </div>

                    <!-- Conceptos del Corbat√≠n -->
                    <div class="definition-grid">
                        <div class="concept-card">
                            <div class="concept-header">
                                <h4 style="color: #e53e3e; margin: 0; font-size: 1.4rem; font-weight: 700;">üö® AMENAZAS</h4>
                            </div>
                            <div class="concept-content">
                                <p style="color: #2d3748; line-height: 1.8; margin-bottom: 15px;"><strong>Las causas que pueden desencadenar el evento central. En el lado izquierdo del corbat√≠n, representan todo lo que puede salir mal.</strong></p>
                            </div>
                        </div>
                        
                        <div class="concept-card">
                            <div class="concept-header">
                                <h4 style="color: #d69e2e; margin: 0; font-size: 1.4rem; font-weight: 700;">üí• EVENTO CENTRAL</h4>
                            </div>
                            <div class="concept-content">
                                <p style="color: #2d3748; line-height: 1.8; margin-bottom: 15px;"><strong>El evento de riesgo que queremos prevenir. Es el "nudo" del corbat√≠n, el punto focal del an√°lisis.</strong></p>
                                <div style="background: #f3e5f5; padding: 15px; border-radius: 8px; border-left: 4px solid #9c27b0;">
                                    <p style="margin: 0; color: #2d3748; font-size: 0.9rem;"><strong>üìä Ejemplo TransLog√≠stica:</strong> "Accidente de tr√°nsito con veh√≠culo de carga en ruta nacional"</p>
                                </div>
                            </div>
                        </div>
                        
                        <div class="concept-card">
                            <div class="concept-header">
                                <h4 style="color: #4facfe; margin: 0; font-size: 1.4rem; font-weight: 700;">‚ö†Ô∏è CONSECUENCIAS</h4>
                            </div>
                            <div class="concept-content">
                                <p style="color: #2d3748; line-height: 1.8; margin-bottom: 15px;"><strong>Los impactos negativos que resultan del evento central. En el lado derecho del corbat√≠n, muestran qu√© puede pasar si el evento ocurre.</strong></p>
                            </div>
                        </div>
                        
                        <div class="concept-card">
                            <div class="concept-header">
                                <h4 style="color: #48bb78; margin: 0; font-size: 1.4rem; font-weight: 700;">üõ°Ô∏è BARRERAS</h4>
                            </div>
                            <div class="concept-content">
                                <p style="color: #2d3748; line-height: 1.8; margin-bottom: 15px;"><strong>Los controles que previenen las amenazas (barreras preventivas) o mitigan las consecuencias (barreras de mitigaci√≥n).</strong></p>
                                <div style="background: #e8f5e8; padding: 15px; border-radius: 8px; border-left: 4px solid #4caf50;">
                                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
                                        <div><strong>üö´ Preventivas:</strong> Evitan que ocurra el evento</div>
                                        <div><strong>üöë Mitigaci√≥n:</strong> Reducen el impacto</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Secci√≥n de Ejemplos Detallados del Corbat√≠n -->
                    <div style="background: linear-gradient(135deg, #f8fafc, #edf2f7); padding: 40px; border-radius: 24px; margin: 40px 0; border: 2px solid rgba(102,126,234,0.1);">
                        <h3 style="text-align: center; color: #667eea; margin-bottom: 30px; font-size: 1.8rem;">üéÄ Elementos Detallados del An√°lisis del Corbat√≠n</h3>
                        
                        <!-- Ejemplos de Amenazas -->
                        <div style="background: #ffffff; padding: 30px; border-radius: 16px; margin-bottom: 30px; box-shadow: 0 4px 15px rgba(0,0,0,0.08);">
                            <h4 style="color: #e53e3e; margin-bottom: 20px; display: flex; align-items: center;"><span style="margin-right: 10px;">üö®</span> Ejemplos de Amenazas en Transporte</h4>
                            <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 20px;">
                                <div style="background: #fff5f5; padding: 20px; border-radius: 12px; border-left: 4px solid #e53e3e;">
                                    <h5 style="color: #c53030; margin: 0 0 15px 0;">üë§ Amenazas Humanas</h5>
                                    <ul style="list-style: none; padding: 0; margin: 0;">
                                        <li style="padding: 6px 0; border-bottom: 1px solid #fed7d7; font-size: 0.95rem;">‚Ä¢ Fatiga del conductor</li>
                                        <li style="padding: 6px 0; border-bottom: 1px solid #fed7d7; font-size: 0.95rem;">‚Ä¢ Velocidad excesiva</li>
                                        <li style="padding: 6px 0; border-bottom: 1px solid #fed7d7; font-size: 0.95rem;">‚Ä¢ Distracci√≥n al volante</li>
                                        <li style="padding: 6px 0; font-size: 0.95rem;">‚Ä¢ Falta de experiencia</li>
                                    </ul>
                                </div>
                                <div style="background: #fff5f5; padding: 20px; border-radius: 12px; border-left: 4px solid #e53e3e;">
                                    <h5 style="color: #c53030; margin: 0 0 15px 0;">üîß Amenazas T√©cnicas</h5>
                                    <ul style="list-style: none; padding: 0; margin: 0;">
                                        <li style="padding: 6px 0; border-bottom: 1px solid #fed7d7; font-size: 0.95rem;">‚Ä¢ Falla de frenos</li>
                                        <li style="padding: 6px 0; border-bottom: 1px solid #fed7d7; font-size: 0.95rem;">‚Ä¢ Neum√°ticos en mal estado</li>
                                        <li style="padding: 6px 0; border-bottom: 1px solid #fed7d7; font-size: 0.95rem;">‚Ä¢ Problemas de direcci√≥n</li>
                                        <li style="padding: 6px 0; font-size: 0.95rem;">‚Ä¢ Sobrecarga del veh√≠culo</li>
                                    </ul>
                                </div>
                            </div>
                        </div>

                        <!-- Caracter√≠sticas del Evento Central -->
                        <div style="background: #ffffff; padding: 30px; border-radius: 16px; margin-bottom: 30px; box-shadow: 0 4px 15px rgba(0,0,0,0.08);">
                            <h4 style="color: #d69e2e; margin-bottom: 20px; display: flex; align-items: center;"><span style="margin-right: 10px;">üí•</span> Caracter√≠sticas del Evento Central</h4>
                            <div style="background: #fff3cd; padding: 25px; border-radius: 12px; color: #856404; margin-bottom: 20px;">
                                <h5 style="margin: 0 0 15px 0;">üéØ Criterios para definir un buen evento central:</h5>
                                <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 20px;">
                                    <ul style="margin: 0; padding-left: 20px;">
                                        <li style="margin: 8px 0;">Debe ser espec√≠fico y claro</li>
                                        <li style="margin: 8px 0;">Representa la p√©rdida de control</li>
                                    </ul>
                                    <ul style="margin: 0; padding-left: 20px;">
                                        <li style="margin: 8px 0;">Es el punto de no retorno</li>
                                        <li style="margin: 8px 0;">Puede tener m√∫ltiples causas y consecuencias</li>
                                    </ul>
                                </div>
                            </div>
                        </div>

                        <!-- Tipos de Consecuencias -->
                        <div style="background: #ffffff; padding: 30px; border-radius: 16px; margin-bottom: 30px; box-shadow: 0 4px 15px rgba(0,0,0,0.08);">
                            <h4 style="color: #4facfe; margin-bottom: 20px; display: flex; align-items: center;"><span style="margin-right: 10px;">‚ö†Ô∏è</span> Tipos de Consecuencias</h4>
                            <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 20px;">
                                <div style="background: #e6fffa; padding: 20px; border-radius: 12px; border-left: 4px solid #4facfe;">
                                    <h5 style="color: #0d47a1; margin: 0 0 15px 0;">üë• Consecuencias Humanas</h5>
                                    <ul style="list-style: none; padding: 0; margin: 0;">
                                        <li style="padding: 6px 0; border-bottom: 1px solid #b3e5fc; font-size: 0.95rem;">‚Ä¢ Lesiones graves o muertes</li>
                                        <li style="padding: 6px 0; border-bottom: 1px solid #b3e5fc; font-size: 0.95rem;">‚Ä¢ Trauma psicol√≥gico</li>
                                        <li style="padding: 6px 0; border-bottom: 1px solid #b3e5fc; font-size: 0.95rem;">‚Ä¢ P√©rdida de personal clave</li>
                                        <li style="padding: 6px 0; font-size: 0.95rem;">‚Ä¢ Impacto en familias</li>
                                    </ul>
                                </div>
                                <div style="background: #e6fffa; padding: 20px; border-radius: 12px; border-left: 4px solid #4facfe;">
                                    <h5 style="color: #0d47a1; margin: 0 0 15px 0;">üí∞ Consecuencias Econ√≥micas</h5>
                                    <ul style="list-style: none; padding: 0; margin: 0;">
                                        <li style="padding: 6px 0; border-bottom: 1px solid #b3e5fc; font-size: 0.95rem;">‚Ä¢ Da√±os materiales</li>
                                        <li style="padding: 6px 0; border-bottom: 1px solid #b3e5fc; font-size: 0.95rem;">‚Ä¢ Costos legales</li>
                                        <li style="padding: 6px 0; border-bottom: 1px solid #b3e5fc; font-size: 0.95rem;">‚Ä¢ P√©rdida de clientes</li>
                                        <li style="padding: 6px 0; font-size: 0.95rem;">‚Ä¢ Aumento de seguros</li>
                                    </ul>
                                </div>
                            </div>
                        </div>

                        <!-- Tipos de Barreras -->
                        <div style="background: #ffffff; padding: 30px; border-radius: 16px; box-shadow: 0 4px 15px rgba(0,0,0,0.08);">
                            <h4 style="color: #48bb78; margin-bottom: 20px; display: flex; align-items: center;"><span style="margin-right: 10px;">üõ°Ô∏è</span> Tipos de Barreras</h4>
                            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 25px;">
                                <div style="background: #f0fff4; padding: 25px; border-radius: 12px; border-left: 4px solid #48bb78;">
                                    <h5 style="color: #2e7d32; margin: 0 0 15px 0;">üö´ BARRERAS PREVENTIVAS</h5>
                                    <p style="color: #424242; font-size: 0.9rem; margin-bottom: 15px;">Evitan que las amenazas se materialicen</p>
                                    <div style="background: #ffffff; padding: 15px; border-radius: 8px; margin-bottom: 12px;">
                                        <strong style="color: #2e7d32;">Capacitaci√≥n:</strong><br>
                                        <span style="font-size: 0.85rem; color: #424242;">Cursos de manejo defensivo, seguridad vial</span>
                                    </div>
                                    <div style="background: #ffffff; padding: 15px; border-radius: 8px; margin-bottom: 12px;">
                                        <strong style="color: #2e7d32;">Mantenimiento:</strong><br>
                                        <span style="font-size: 0.85rem; color: #424242;">Inspecciones regulares, cambio de piezas</span>
                                    </div>
                                    <div style="background: #ffffff; padding: 15px; border-radius: 8px;">
                                        <strong style="color: #2e7d32;">Controles:</strong><br>
                                        <span style="font-size: 0.85rem; color: #424242;">L√≠mites de velocidad, descansos obligatorios</span>
                                    </div>
                                </div>
                                <div style="background: #f0fff4; padding: 25px; border-radius: 12px; border-left: 4px solid #48bb78;">
                                    <h5 style="color: #2e7d32; margin: 0 0 15px 0;">üöë BARRERAS DE MITIGACI√ìN</h5>
                                    <p style="color: #424242; font-size: 0.9rem; margin-bottom: 15px;">Reducen el impacto de las consecuencias</p>
                                    <div style="background: #ffffff; padding: 15px; border-radius: 8px; margin-bottom: 12px;">
                                        <strong style="color: #2e7d32;">Emergencia:</strong><br>
                                        <span style="font-size: 0.85rem; color: #424242;">Servicios m√©dicos, bomberos, rescate</span>
                                    </div>
                                    <div style="background: #ffffff; padding: 15px; border-radius: 8px; margin-bottom: 12px;">
                                        <strong style="color: #2e7d32;">Seguros:</strong><br>
                                        <span style="font-size: 0.85rem; color: #424242;">Cobertura m√©dica, responsabilidad civil</span>
                                    </div>
                                    <div style="background: #ffffff; padding: 15px; border-radius: 8px;">
                                        <strong style="color: #2e7d32;">Comunicaci√≥n:</strong><br>
                                        <span style="font-size: 0.85rem; color: #424242;">Planes de crisis, relaciones p√∫blicas</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>



                    <div style="text-align: center; margin: 40px 0;">
                        <button class="nav-btn" onclick="openBowtieApp()" style="font-size: 1.2rem; padding: 25px 50px; background: linear-gradient(135deg, #f093fb, #f5576c, #4facfe);">
                            üéÄ Crear Mi An√°lisis del Corbat√≠n
                        </button>
                        <p style="color: #4a5568; margin-top: 15px; font-size: 1.1rem;">Herramienta interactiva para crear tu propio an√°lisis visual</p>
                    </div>

                    <div class="eureka-moment">
                        <h4>üí° El Poder del Corbat√≠n</h4>
                        <p>"Con esta herramienta, Ana pudo visualizar de manera completa todos los riesgos de TransLog√≠stica. Ya no era solo una lista de problemas, sino un mapa estrat√©gico que mostraba exactamente d√≥nde invertir recursos para m√°xima efectividad en la prevenci√≥n."</p>
                    </div>
                </div>

                <!-- P√°gina 5: Manos a la Obra -->
                <div id="page5" class="story-page">
                    <div class="story-header">
                        <h2 class="story-title">üöÄ Manos a la Obra</h2>
                        <p class="story-subtitle">Cap√≠tulo 5: Ana implementa las herramientas pr√°cticas</p>
                    </div>

                    <div class="story-content">
                        <p>Tres meses despu√©s de su "despertar", Ana hab√≠a transformado completamente la gesti√≥n de riesgos en TransLog√≠stica. Ahora ten√≠a herramientas pr√°cticas que le permit√≠an evaluar cualquier situaci√≥n de riesgo de manera sistem√°tica y objetiva.</p>

                        <div class="quote-box">
                            "Ya no tomamos decisiones basadas en intuici√≥n o experiencia √∫nicamente. Ahora tenemos datos, metodolog√≠a y herramientas que nos permiten ser precisos y efectivos en nuestra gesti√≥n de riesgos."
                        </div>
                    </div>
                </div>

                <!-- Navegaci√≥n entre p√°ginas -->
                <div class="page-navigation">
                    <button id="prevBtn" class="nav-btn" onclick="changePage(-1)">‚Üê Anterior</button>
                    
                    <div class="page-indicators">
                        <div class="page-dot active" onclick="goToPage(1)"></div>
                        <div class="page-dot" onclick="goToPage(2)"></div>
                        <div class="page-dot" onclick="goToPage(3)"></div>
                        <div class="page-dot" onclick="goToPage(4)"></div>
                        <div class="page-dot" onclick="goToPage(5)"></div>
                    </div>
                    
                    <button id="nextBtn" class="nav-btn" onclick="changePage(1)">Siguiente ‚Üí</button>
                </div>
            </main>
        </div>
    </div>

    <!-- Modal de la Herramienta ISO 39002 -->
    <div id="iso39002ToolModal" class="modal">
        <div class="modal-container">
            <div class="modal-header">
                <h2 style="margin: 0; color: #2d3748;">üîß Herramienta de An√°lisis ISO 39002</h2>
                <button class="close-btn" onclick="closeISO39002Tool()">√ó</button>
            </div>

            <div style="background: linear-gradient(135deg, #e6fffa, #f0fff4); padding: 25px; border-radius: 16px; margin-bottom: 30px; border-left: 6px solid #48bb78;">
                <h3 style="color: #2d3748; margin: 0 0 15px 0;">üéØ An√°lisis de Riesgos en Infraestructura Vial</h3>
                <p style="color: #4a5568; margin: 0; line-height: 1.8;">Herramienta especializada para evaluar riesgos en infraestructura vial seg√∫n la norma ISO 39002. Analiza vulnerabilidades, amenazas y calcula niveles de riesgo de manera sistem√°tica.</p>
            </div>

            <!-- Secci√≥n 1: Datos del Activo -->
            <div style="background: #f8fafc; padding: 25px; border-radius: 16px; margin-bottom: 25px; border: 2px solid #e2e8f0;">
                <h3 style="color: #2d3748; margin: 0 0 20px 0; display: flex; align-items: center;">
                    <span style="background: linear-gradient(135deg, #667eea, #764ba2); color: white; width: 30px; height: 30px; border-radius: 50%; display: flex; align-items: center; justify-content: center; margin-right: 10px; font-weight: bold;">1</span>
                    üìã Informaci√≥n del Activo de Infraestructura
                </h3>
                
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 20px;">
                    <div>
                        <label style="display: block; margin-bottom: 8px; font-weight: 600; color: #4a5568;">üèóÔ∏è Tipo de Infraestructura:</label>
                        <select id="toolAssetType" style="width: 100%; padding: 12px; border: 2px solid #e2e8f0; border-radius: 8px; font-size: 0.9rem;">
                            <option value="">Seleccionar tipo</option>
                            <option value="puente">üåâ Puente Vehicular</option>
                            <option value="tunel">üöá T√∫nel</option>
                            <option value="autopista">üõ£Ô∏è Autopista/Carretera</option>
                            <option value="interseccion">üö¶ Intersecci√≥n Vial</option>
                            <option value="viaducto">üèóÔ∏è Viaducto</option>
                            <option value="terminal">üöå Terminal de Transporte</option>
                            <option value="peaje">üí∞ Plaza de Peaje</option>
                        </select>
                    </div>
                    <div>
                        <label style="display: block; margin-bottom: 8px; font-weight: 600; color: #4a5568;">üìÖ A√±o de Construcci√≥n:</label>
                        <input type="number" id="toolConstructionYear" min="1950" max="2024" placeholder="Ej: 1995" style="width: 100%; padding: 12px; border: 2px solid #e2e8f0; border-radius: 8px; font-size: 0.9rem;">
                    </div>
                </div>

                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 20px;">
                    <div>
                        <label style="display: block; margin-bottom: 8px; font-weight: 600; color: #4a5568;">üìç Ubicaci√≥n Geogr√°fica:</label>
                        <input type="text" id="toolLocation" placeholder="Ej: Km 45 Ruta Nacional 9" style="width: 100%; padding: 12px; border: 2px solid #e2e8f0; border-radius: 8px; font-size: 0.9rem;">
                    </div>
                    <div>
                        <label style="display: block; margin-bottom: 8px; font-weight: 600; color: #4a5568;">üöó Tr√°fico Diario Promedio:</label>
                        <input type="number" id="toolTrafficVolume" placeholder="Veh√≠culos/d√≠a" style="width: 100%; padding: 12px; border: 2px solid #e2e8f0; border-radius: 8px; font-size: 0.9rem;">
                    </div>
                </div>

                <div>
                    <label style="display: block; margin-bottom: 8px; font-weight: 600; color: #4a5568;">üìù Descripci√≥n del Activo:</label>
                    <textarea id="toolAssetDescription" rows="3" placeholder="Describe las caracter√≠sticas principales del activo..." style="width: 100%; padding: 12px; border: 2px solid #e2e8f0; border-radius: 8px; font-size: 0.9rem; resize: vertical;"></textarea>
                </div>
            </div>

            <!-- Secci√≥n 2: Evaluaci√≥n de Amenazas -->
            <div style="background: #f8fafc; padding: 25px; border-radius: 16px; margin-bottom: 25px; border: 2px solid #e2e8f0;">
                <h3 style="color: #2d3748; margin: 0 0 20px 0; display: flex; align-items: center;">
                    <span style="background: linear-gradient(135deg, #667eea, #764ba2); color: white; width: 30px; height: 30px; border-radius: 50%; display: flex; align-items: center; justify-content: center; margin-right: 10px; font-weight: bold;">2</span>
                    ‚ö†Ô∏è Evaluaci√≥n de Amenazas
                </h3>

                <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 15px;">
                    <div style="background: #fff5f5; padding: 15px; border-radius: 12px; border-left: 4px solid #e53e3e;">
                        <h4 style="color: #e53e3e; margin: 0 0 15px 0; font-size: 1rem;">üåç Amenazas Naturales</h4>
                        <div style="display: flex; flex-direction: column; gap: 8px;">
                            <label style="display: flex; align-items: center; font-size: 0.9rem;">
                                <input type="checkbox" id="threat_sismo" style="margin-right: 8px;"> Actividad s√≠smica
                            </label>
                            <label style="display: flex; align-items: center; font-size: 0.9rem;">
                                <input type="checkbox" id="threat_inundacion" style="margin-right: 8px;"> Inundaciones
                            </label>
                            <label style="display: flex; align-items: center; font-size: 0.9rem;">
                                <input type="checkbox" id="threat_viento" style="margin-right: 8px;"> Vientos fuertes
                            </label>
                            <label style="display: flex; align-items: center; font-size: 0.9rem;">
                                <input type="checkbox" id="threat_deslizamiento" style="margin-right: 8px;"> Deslizamientos
                            </label>
                        </div>
                    </div>

                    <div style="background: #fffbf0; padding: 15px; border-radius: 12px; border-left: 4px solid #d69e2e;">
                        <h4 style="color: #d69e2e; margin: 0 0 15px 0; font-size: 1rem;">üîß Amenazas T√©cnicas</h4>
                        <div style="display: flex; flex-direction: column; gap: 8px;">
                            <label style="display: flex; align-items: center; font-size: 0.9rem;">
                                <input type="checkbox" id="threat_fatiga" style="margin-right: 8px;"> Fatiga estructural
                            </label>
                            <label style="display: flex; align-items: center; font-size: 0.9rem;">
                                <input type="checkbox" id="threat_corrosion" style="margin-right: 8px;"> Corrosi√≥n
                            </label>
                            <label style="display: flex; align-items: center; font-size: 0.9rem;">
                                <input type="checkbox" id="threat_sobrecarga" style="margin-right: 8px;"> Sobrecarga
                            </label>
                            <label style="display: flex; align-items: center; font-size: 0.9rem;">
                                <input type="checkbox" id="threat_desgaste" style="margin-right: 8px;"> Desgaste normal
                            </label>
                        </div>
                    </div>

                    <div style="background: #f0fff4; padding: 15px; border-radius: 12px; border-left: 4px solid #48bb78;">
                        <h4 style="color: #48bb78; margin: 0 0 15px 0; font-size: 1rem;">üë• Amenazas Humanas</h4>
                        <div style="display: flex; flex-direction: column; gap: 8px;">
                            <label style="display: flex; align-items: center; font-size: 0.9rem;">
                                <input type="checkbox" id="threat_impacto" style="margin-right: 8px;"> Impacto vehicular
                            </label>
                            <label style="display: flex; align-items: center; font-size: 0.9rem;">
                                <input type="checkbox" id="threat_vandalismo" style="margin-right: 8px;"> Vandalismo
                            </label>
                            <label style="display: flex; align-items: center; font-size: 0.9rem;">
                                <input type="checkbox" id="threat_mantenimiento" style="margin-right: 8px;"> Mant. deficiente
                            </label>
                            <label style="display: flex; align-items: center; font-size: 0.9rem;">
                                <input type="checkbox" id="threat_uso_inadecuado" style="margin-right: 8px;"> Uso inadecuado
                            </label>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Secci√≥n 3: Matriz de Riesgos ISO 39002 -->
            <div style="background: #f8fafc; padding: 25px; border-radius: 16px; margin-bottom: 25px; border: 2px solid #e2e8f0;">
                <h3 style="color: #2d3748; margin: 0 0 20px 0; display: flex; align-items: center;">
                    <span style="background: linear-gradient(135deg, #667eea, #764ba2); color: white; width: 30px; height: 30px; border-radius: 50%; display: flex; align-items: center; justify-content: center; margin-right: 10px; font-weight: bold;">3</span>
                    üìä Matriz de Evaluaci√≥n ISO 39002
                </h3>

                <div style="background: #e6fffa; padding: 20px; border-radius: 12px; margin-bottom: 20px; border-left: 4px solid #4facfe;">
                    <h4 style="color: #2d3748; margin: 0 0 15px 0;">üìã Sistema de Calificaci√≥n ISO 39002</h4>
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
                        <div>
                            <h5 style="color: #4facfe; margin: 0 0 10px 0;">üìà Probabilidad/Frecuencia:</h5>
                            <ul style="margin: 0; padding-left: 20px; font-size: 0.9rem; color: #4a5568;">
                                <li><strong>A:</strong> Ha o√≠do hablar de √©l en la industria</li>
                                <li><strong>B:</strong> Ha ocurrido en la empresa o m√°s de una vez al a√±o en la industria</li>
                                <li><strong>C:</strong> Ha ocurrido en el lugar, o m√°s de una vez al a√±o en la empresa</li>
                                <li><strong>D:</strong> Ha ocurrido m√°s de una vez al a√±o en el lugar</li>
                            </ul>
                        </div>
                        <div>
                            <h5 style="color: #4facfe; margin: 0 0 10px 0;">üí• Severidad/Consecuencia:</h5>
                            <ul style="margin: 0; padding-left: 20px; font-size: 0.9rem; color: #4a5568;">
                                <li><strong>1:</strong> Lesi√≥n leve. Da√±o leve. Efecto leve</li>
                                <li><strong>2:</strong> Lesi√≥n menor. Da√±o menor. Efecto menor</li>
                                <li><strong>3:</strong> Lesi√≥n grave. Da√±o local. Efecto localizado</li>
                                <li><strong>4:</strong> Posible muerte. Da√±o extenso. Efecto extenso</li>
                            </ul>
                        </div>
                    </div>
                </div>

                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 20px;">
                    <div>
                        <label style="display: block; margin-bottom: 8px; font-weight: 600; color: #4a5568;">üìà Probabilidad/Frecuencia:</label>
                        <select id="toolProbability" style="width: 100%; padding: 12px; border: 2px solid #e2e8f0; border-radius: 8px; font-size: 0.9rem;">
                            <option value="">Seleccionar</option>
                            <option value="A">A - Ha o√≠do hablar en la industria</option>
                            <option value="B">B - Ha ocurrido en empresa/industria</option>
                            <option value="C">C - Ha ocurrido en lugar/empresa</option>
                            <option value="D">D - M√°s de una vez al a√±o aqu√≠</option>
                        </select>
                    </div>
                    <div>
                        <label style="display: block; margin-bottom: 8px; font-weight: 600; color: #4a5568;">üí• Severidad/Consecuencia:</label>
                        <select id="toolSeverity" style="width: 100%; padding: 12px; border: 2px solid #e2e8f0; border-radius: 8px; font-size: 0.9rem;">
                            <option value="">Seleccionar</option>
                            <option value="1">1 - Lesi√≥n leve, da√±o leve</option>
                            <option value="2">2 - Lesi√≥n menor, da√±o menor</option>
                            <option value="3">3 - Lesi√≥n grave, da√±o local</option>
                            <option value="4">4 - Posible muerte, da√±o extenso</option>
                        </select>
                    </div>
                </div>

                <div>
                    <label style="display: block; margin-bottom: 8px; font-weight: 600; color: #4a5568;">üìç Distancia del tramo (km):</label>
                    <input type="number" id="toolDistance" step="0.1" placeholder="Ej: 1.5" style="width: 100%; padding: 12px; border: 2px solid #e2e8f0; border-radius: 8px; font-size: 0.9rem; margin-bottom: 20px;">
                </div>

                <button onclick="calculateISO39002Risk()" style="background: linear-gradient(135deg, #667eea, #764ba2); color: white; border: none; padding: 15px 30px; border-radius: 12px; font-weight: 600; cursor: pointer; font-size: 1.1rem; width: 100%; margin: 20px 0; transition: all 0.3s ease;" onmouseover="this.style.transform='translateY(-2px)'" onmouseout="this.style.transform='translateY(0px)'">
                    üìä Calcular Calificaci√≥n de Riesgo ISO 39002
                </button>

                <div id="toolRiskResult" style="display: none;"></div>
            </div>

            <!-- Secci√≥n 4: Recomendaciones -->
            <div id="toolRecommendations" style="display: none; background: #f8fafc; padding: 25px; border-radius: 16px; margin-bottom: 25px; border: 2px solid #e2e8f0;">
                <h3 style="color: #2d3748; margin: 0 0 20px 0; display: flex; align-items: center;">
                    <span style="background: linear-gradient(135deg, #667eea, #764ba2); color: white; width: 30px; height: 30px; border-radius: 50%; display: flex; align-items: center; justify-content: center; margin-right: 10px; font-weight: bold;">4</span>
                    üí° Recomendaciones de Tratamiento
                </h3>
                <div id="toolRecommendationsContent"></div>
            </div>

            <div style="text-align: center; margin-top: 30px; padding-top: 20px; border-top: 2px solid #e2e8f0;">
                <button onclick="exportInfrastructureReport()" style="background: linear-gradient(135deg, #48bb78, #38a169); color: white; border: none; padding: 15px 30px; border-radius: 12px; font-weight: 600; cursor: pointer; font-size: 1.1rem; margin-right: 15px;">
                    üìÑ Exportar Reporte de An√°lisis
                </button>
                <button onclick="resetInfrastructureTool()" style="background: linear-gradient(135deg, #ed8936, #dd6b20); color: white; border: none; padding: 15px 30px; border-radius: 12px; font-weight: 600; cursor: pointer; font-size: 1.1rem; margin-right: 15px;">
                    üîÑ Nuevo An√°lisis
                </button>
                <button onclick="closeISO39002Tool()" style="background: linear-gradient(135deg, #cbd5e0, #a0aec0); color: #4a5568; border: none; padding: 15px 30px; border-radius: 12px; font-weight: 600; cursor: pointer; font-size: 1.1rem;">
                    ‚úÖ Cerrar Herramienta
                </button>
            </div>
        </div>
    </div>

    <!-- Modal del Taller ISO 39002 -->
    <div id="iso39002Modal" class="modal">
        <div class="modal-container">
            <div class="modal-header">
                <h2 style="margin: 0; color: #2d3748;">üèóÔ∏è Taller Pr√°ctico ISO 39002 con IA</h2>
                <button class="close-btn" onclick="closeISO39002Workshop()">√ó</button>
            </div>

            <div style="background: linear-gradient(135deg, #e6fffa, #f0fff4); padding: 25px; border-radius: 16px; margin-bottom: 30px; border-left: 6px solid #48bb78;">
                <h3 style="color: #2d3748; margin: 0 0 15px 0;">üéØ Objetivo del Taller</h3>
                <p style="color: #4a5568; margin: 0; line-height: 1.8;">Aprende a implementar la norma ISO 39002 para gesti√≥n de riesgos en infraestructura vial utilizando inteligencia artificial para acelerar el proceso de evaluaci√≥n y an√°lisis.</p>
            </div>

            <!-- Paso 1 -->
            <div class="workshop-step">
                <div class="step-number">1</div>
                <h3 class="step-title">üîç Identificaci√≥n del Activo de Infraestructura</h3>
                <div class="step-content">
                    <p>Seg√∫n ISO 39002, el primer paso es identificar y caracterizar el activo de infraestructura vial que ser√° evaluado.</p>
                    
                    <div class="ai-workshop-tool">
                        <h4 style="margin-bottom: 20px;">ü§ñ Asistente IA - Caracterizaci√≥n de Activos</h4>
                        <label style="display: block; margin-bottom: 8px; font-weight: 600;">üìç Describe el activo de infraestructura:</label>
                        <textarea class="workshop-input" id="assetDescription" rows="3" placeholder="Ej: Puente vehicular de 150m sobre r√≠o, construido en 1985, tr√°fico de 15,000 veh√≠culos/d√≠a..."></textarea>
                        
                        <label style="display: block; margin-bottom: 8px; font-weight: 600;">üè∑Ô∏è Tipo de infraestructura:</label>
                        <select class="workshop-input" id="assetType">
                            <option value="">Seleccionar tipo</option>
                            <option value="puente">üåâ Puente</option>
                            <option value="tunel">üöá T√∫nel</option>
                            <option value="carretera">üõ£Ô∏è Carretera/Autopista</option>
                            <option value="interseccion">üö¶ Intersecci√≥n</option>
                            <option value="terminal">üöå Terminal de Transporte</option>
                            <option value="peaje">üí∞ Plaza de Peaje</option>
                        </select>
                        
                        <button class="workshop-btn" onclick="analyzeAsset()">üîç Analizar Activo con IA</button>
                        
                        <div id="assetAnalysis" class="workshop-result" style="display: none;">
                            <h5 style="margin-bottom: 15px;">üìä An√°lisis del Activo</h5>
                            <div id="assetAnalysisContent"></div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Paso 2 -->
            <div class="workshop-step">
                <div class="step-number">2</div>
                <h3 class="step-title">‚ö†Ô∏è Evaluaci√≥n de Amenazas y Vulnerabilidades</h3>
                <div class="step-content">
                    <p>ISO 39002 requiere una evaluaci√≥n sistem√°tica de amenazas naturales, tecnol√≥gicas y humanas que pueden afectar la infraestructura.</p>
                    
                    <div class="ai-workshop-tool">
                        <h4 style="margin-bottom: 20px;">ü§ñ Generador IA de Matriz de Amenazas</h4>
                        
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
                            <div>
                                <label style="display: block; margin-bottom: 8px; font-weight: 600;">üåç Ubicaci√≥n geogr√°fica:</label>
                                <input type="text" class="workshop-input" id="assetLocation" placeholder="Ej: Zona s√≠smica alta, costa atl√°ntica">
                            </div>
                            <div>
                                <label style="display: block; margin-bottom: 8px; font-weight: 600;">üìÖ Antig√ºedad (a√±os):</label>
                                <input type="number" class="workshop-input" id="assetAge" placeholder="Ej: 25">
                            </div>
                        </div>
                        
                        <label style="display: block; margin-bottom: 8px; font-weight: 600;">üö¶ Nivel de tr√°fico:</label>
                        <select class="workshop-input" id="trafficLevel">
                            <option value="">Seleccionar nivel</option>
                            <option value="bajo">Bajo (< 5,000 veh/d√≠a)</option>
                            <option value="medio">Medio (5,000 - 20,000 veh/d√≠a)</option>
                            <option value="alto">Alto (20,000 - 50,000 veh/d√≠a)</option>
                            <option value="muy_alto">Muy Alto (> 50,000 veh/d√≠a)</option>
                        </select>
                        
                        <button class="workshop-btn" onclick="generateThreatMatrix()">‚ö° Generar Matriz de Amenazas</button>
                        
                        <div id="threatMatrix" class="workshop-result" style="display: none;">
                            <h5 style="margin-bottom: 15px;">üéØ Matriz de Amenazas Personalizada</h5>
                            <div id="threatMatrixContent"></div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Paso 3 -->
            <div class="workshop-step">
                <div class="step-number">3</div>
                <h3 class="step-title">üìä An√°lisis Cuantitativo de Riesgos</h3>
                <div class="step-content">
                    <p>Aplicamos la metodolog√≠a ISO 39002 para cuantificar riesgos usando probabilidad, impacto y exposici√≥n.</p>
                    
                    <div class="ai-workshop-tool">
                        <h4 style="margin-bottom: 20px;">ü§ñ Calculadora IA de Riesgos ISO 39002</h4>
                        
                        <label style="display: block; margin-bottom: 8px; font-weight: 600;">üéØ Selecciona la amenaza principal:</label>
                        <select class="workshop-input" id="mainThreat">
                            <option value="">Seleccionar amenaza</option>
                            <option value="sismo">üåç Actividad s√≠smica</option>
                            <option value="inundacion">üåä Inundaciones</option>
                            <option value="fatiga">üîß Fatiga estructural</option>
                            <option value="sobrecarga">‚öñÔ∏è Sobrecarga vehicular</option>
                            <option value="corrosion">ü¶† Corrosi√≥n de materiales</option>
                            <option value="impacto">üí• Impacto vehicular</option>
                        </select>
                        
                        <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 15px; margin: 15px 0;">
                            <div>
                                <label style="display: block; margin-bottom: 8px; font-weight: 600;">üìà Probabilidad (1-5): <span id="probISO">3</span></label>
                                <input type="range" min="1" max="5" value="3" class="workshop-input" id="probabilityISO" oninput="updateISOCalculation()" style="background: rgba(255,255,255,0.3);">
                            </div>
                            <div>
                                <label style="display: block; margin-bottom: 8px; font-weight: 600;">üí• Impacto (1-5): <span id="impactISO">3</span></label>
                                <input type="range" min="1" max="5" value="3" class="workshop-input" id="impactISO" oninput="updateISOCalculation()" style="background: rgba(255,255,255,0.3);">
                            </div>
                            <div>
                                <label style="display: block; margin-bottom: 8px; font-weight: 600;">üë• Exposici√≥n (1-5): <span id="exposureISO">3</span></label>
                                <input type="range" min="1" max="5" value="3" class="workshop-input" id="exposureISO" oninput="updateISOCalculation()" style="background: rgba(255,255,255,0.3);">
                            </div>
                        </div>
                        
                        <button class="workshop-btn" onclick="calculateISORisk()">üìä Calcular Riesgo ISO 39002</button>
                        
                        <div id="isoRiskResult" class="workshop-result" style="display: none;">
                            <h5 style="margin-bottom: 15px;">üéØ Resultado del An√°lisis</h5>
                            <div id="isoRiskContent"></div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Paso 4 -->
            <div class="workshop-step">
                <div class="step-number">4</div>
                <h3 class="step-title">üõ°Ô∏è Plan de Tratamiento de Riesgos</h3>
                <div class="step-content">
                    <p>Desarrollamos estrategias de mitigaci√≥n alineadas con los principios de resiliencia de ISO 39002.</p>
                    
                    <div class="ai-workshop-tool">
                        <h4 style="margin-bottom: 20px;">ü§ñ Generador IA de Planes de Mitigaci√≥n</h4>
                        
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
                            <div>
                                <label style="display: block; margin-bottom: 8px; font-weight: 600;">üí∞ Presupuesto disponible:</label>
                                <select class="workshop-input" id="mitigationBudget">
                                    <option value="">Seleccionar presupuesto</option>
                                    <option value="bajo">Bajo (< $100K USD)</option>
                                    <option value="medio">Medio ($100K - $1M USD)</option>
                                    <option value="alto">Alto (> $1M USD)</option>
                                </select>
                            </div>
                            <div>
                                <label style="display: block; margin-bottom: 8px; font-weight: 600;">‚è∞ Tiempo de implementaci√≥n:</label>
                                <select class="workshop-input" id="implementationTime">
                                    <option value="">Seleccionar tiempo</option>
                                    <option value="inmediato">Inmediato (< 3 meses)</option>
                                    <option value="corto">Corto plazo (3-12 meses)</option>
                                    <option value="largo">Largo plazo (> 12 meses)</option>
                                </select>
                            </div>
                        </div>
                        
                        <label style="display: block; margin-bottom: 8px; font-weight: 600;">üéØ Estrategia preferida:</label>
                        <select class="workshop-input" id="mitigationStrategy">
                            <option value="">Seleccionar estrategia</option>
                            <option value="evitar">üö´ Evitar (Eliminar la amenaza)</option>
                            <option value="reducir">üìâ Reducir (Minimizar probabilidad/impacto)</option>
                            <option value="transferir">üîÑ Transferir (Seguros/tercerizaci√≥n)</option>
                            <option value="aceptar">‚úÖ Aceptar (Monitoreo y contingencia)</option>
                        </select>
                        
                        <button class="workshop-btn" onclick="generateMitigationPlan()">üöÄ Generar Plan de Mitigaci√≥n</button>
                        
                        <div id="mitigationPlan" class="workshop-result" style="display: none;">
                            <h5 style="margin-bottom: 15px;">üìã Plan de Tratamiento Personalizado</h5>
                            <div id="mitigationPlanContent"></div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Paso 5 -->
            <div class="workshop-step">
                <div class="step-number">5</div>
                <h3 class="step-title">üìà Monitoreo y Mejora Continua</h3>
                <div class="step-content">
                    <p>ISO 39002 enfatiza la importancia del monitoreo continuo y la adaptaci√≥n de las estrategias de gesti√≥n de riesgos.</p>
                    
                    <div class="ai-workshop-tool">
                        <h4 style="margin-bottom: 20px;">ü§ñ Sistema IA de Monitoreo Predictivo</h4>
                        
                        <label style="display: block; margin-bottom: 8px; font-weight: 600;">üìä Indicadores clave a monitorear:</label>
                        <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 10px; margin-bottom: 15px;">
                            <label style="display: flex; align-items: center; color: white;">
                                <input type="checkbox" id="kpi1" style="margin-right: 8px;"> Estado estructural
                            </label>
                            <label style="display: flex; align-items: center; color: white;">
                                <input type="checkbox" id="kpi2" style="margin-right: 8px;"> Volumen de tr√°fico
                            </label>
                            <label style="display: flex; align-items: center; color: white;">
                                <input type="checkbox" id="kpi3" style="margin-right: 8px;"> Condiciones clim√°ticas
                            </label>
                            <label style="display: flex; align-items: center; color: white;">
                                <input type="checkbox" id="kpi4" style="margin-right: 8px;"> Incidentes de seguridad
                            </label>
                        </div>
                        
                        <label style="display: block; margin-bottom: 8px; font-weight: 600;">‚è±Ô∏è Frecuencia de monitoreo:</label>
                        <select class="workshop-input" id="monitoringFrequency">
                            <option value="">Seleccionar frecuencia</option>
                            <option value="continuo">Continuo (Tiempo real)</option>
                            <option value="diario">Diario</option>
                            <option value="semanal">Semanal</option>
                            <option value="mensual">Mensual</option>
                        </select>
                        
                        <button class="workshop-btn" onclick="generateMonitoringPlan()">üìä Generar Plan de Monitoreo</button>
                        
                        <div id="monitoringPlan" class="workshop-result" style="display: none;">
                            <h5 style="margin-bottom: 15px;">üìà Sistema de Monitoreo Inteligente</h5>
                            <div id="monitoringPlanContent"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div style="text-align: center; margin-top: 30px; padding-top: 20px; border-top: 2px solid #e2e8f0;">
                <button onclick="exportISO39002Report()" style="background: linear-gradient(135deg, #48bb78, #38a169); color: white; border: none; padding: 15px 30px; border-radius: 12px; font-weight: 600; cursor: pointer; font-size: 1.1rem; margin-right: 15px;">
                    üìÑ Exportar Reporte ISO 39002
                </button>
                <button onclick="closeISO39002Workshop()" style="background: linear-gradient(135deg, #cbd5e0, #a0aec0); color: #4a5568; border: none; padding: 15px 30px; border-radius: 12px; font-weight: 600; cursor: pointer; font-size: 1.1rem;">
                    ‚úÖ Finalizar Taller
                </button>
            </div>
        </div>
    </div>

    <!-- Modal de la Aplicaci√≥n del Corbat√≠n -->
    <div id="bowtieAppModal" class="modal">
        <div class="modal-container">
            <div class="modal-header">
                <h2 style="margin: 0; color: #2d3748;">üéÄ Aplicaci√≥n del An√°lisis del Corbat√≠n</h2>
                <button class="close-btn" onclick="closeBowtieApp()">√ó</button>
            </div>

            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 20px;">
                <div style="background: #f7fafc; padding: 20px; border-radius: 12px;">
                    <label style="display: block; margin-bottom: 8px; font-weight: 600; color: #2d3748;">üéØ Evento Central</label>
                    <input type="text" id="centralEvent" placeholder="Ej: Accidente en intersecci√≥n" style="width: 100%; padding: 10px; border: 2px solid #e2e8f0; border-radius: 8px;">
                </div>
                <div style="background: #f7fafc; padding: 20px; border-radius: 12px;">
                    <label style="display: block; margin-bottom: 8px; font-weight: 600; color: #2d3748;">üìç Ubicaci√≥n</label>
                    <input type="text" id="eventLocation" placeholder="Ej: Km 45 Ruta Nacional 9" style="width: 100%; padding: 10px; border: 2px solid #e2e8f0; border-radius: 8px;">
                </div>
            </div>

            <button onclick="generateBowtieVisualization()" style="background: linear-gradient(135deg, #667eea, #764ba2); color: white; border: none; padding: 15px 30px; border-radius: 12px; font-weight: 600; cursor: pointer; font-size: 1.1rem; width: 100%; margin: 20px 0;">
                üéÄ Generar Visualizaci√≥n del Corbat√≠n
            </button>

            <div id="bowtieVisualization" style="display: none;">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                    <h3 style="color: #2d3748; margin: 0;">üìä Visualizaci√≥n Generada</h3>
                    <button onclick="exportBowtie()" style="background: #48bb78; color: white; border: none; padding: 12px 25px; border-radius: 10px; font-weight: 600; cursor: pointer;">üìÑ Exportar An√°lisis</button>
                </div>
                <div id="generatedBowtieDisplay"></div>
            </div>
        </div>
    </div>

    <script>
        let microcourseTimer;
        let timeRemaining = 1200; // 20 minutes
        let isRunning = false;

        function startMicrocourse() {
            if (!isRunning) {
                isRunning = true;
                microcourseTimer = setInterval(updateTimer, 1000);
                document.querySelector('.start-btn').textContent = 'Pausar Microcurso';
                document.querySelector('.start-btn').style.background = 'rgba(255,255,255,0.3)';
            } else {
                pauseMicrocourse();
            }
        }

        function pauseMicrocourse() {
            isRunning = false;
            clearInterval(microcourseTimer);
            document.querySelector('.start-btn').textContent = 'Continuar Microcurso';
            document.querySelector('.start-btn').style.background = 'rgba(255,255,255,0.2)';
        }

        function updateTimer() {
            timeRemaining--;
            const minutes = Math.floor(timeRemaining / 60);
            const seconds = timeRemaining % 60;
            document.getElementById('timerDisplay').textContent = 
                `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
            
            if (timeRemaining <= 0) {
                clearInterval(microcourseTimer);
                completeMicrocourse();
            }
        }

        function completeMicrocourse() {
            document.getElementById('timerDisplay').textContent = '¬°Completado!';
            document.querySelector('.start-btn').textContent = 'Microcurso Finalizado';
            document.querySelector('.start-btn').disabled = true;
            document.querySelector('.start-btn').style.opacity = '0.6';
        }

        // Page navigation variables
        let currentPage = 1;
        const totalPages = 5;

        // Page navigation functions
        function goToPage(pageNumber) {
            if (pageNumber < 1 || pageNumber > totalPages) return;
            
            // Hide all pages
            document.querySelectorAll('.story-page').forEach(page => {
                page.classList.remove('active');
            });
            
            // Show selected page
            document.getElementById(`page${pageNumber}`).classList.add('active');
            
            // Update navigation
            updateNavigation(pageNumber);
            updateSidebarNavigation(pageNumber);
            updatePageIndicators(pageNumber);
            
            currentPage = pageNumber;
            
            // Scroll to top of main content
            const mainContent = document.querySelector('.main-content');
            mainContent.scrollTo({
                top: 0,
                behavior: 'smooth'
            });
        }

        function changePage(direction) {
            const newPage = currentPage + direction;
            goToPage(newPage);
            
            // Scroll to top of the page
            window.scrollTo({
                top: 0,
                behavior: 'smooth'
            });
        }

        function updateNavigation(pageNumber) {
            const prevBtn = document.getElementById('prevBtn');
            const nextBtn = document.getElementById('nextBtn');
            
            prevBtn.disabled = pageNumber === 1;
            nextBtn.disabled = pageNumber === totalPages;
            
            if (pageNumber === totalPages) {
                nextBtn.textContent = 'üéâ Finalizar';
            } else {
                nextBtn.textContent = 'Siguiente ‚Üí';
            }
        }

        function updateSidebarNavigation(pageNumber) {
            // Update sidebar navigation
            document.querySelectorAll('.module-item').forEach((item, index) => {
                item.classList.remove('active');
                if (index + 1 === pageNumber) {
                    item.classList.add('active');
                }
            });
            
            // Update horizontal navigation
            document.querySelectorAll('.horizontal-nav-item').forEach((item) => {
                item.classList.remove('active');
                if (parseInt(item.dataset.page) === pageNumber) {
                    item.classList.add('active');
                }
            });
        }

        function updatePageIndicators(pageNumber) {
            document.querySelectorAll('.page-dot').forEach((dot, index) => {
                dot.classList.remove('active');
                if (index + 1 === pageNumber) {
                    dot.classList.add('active');
                }
            });
        }

        // Flip card functionality
        function flipCard(card) {
            card.classList.toggle('flipped');
        }

        // Expandable content functionality
        function toggleExpand(contentId) {
            const content = document.getElementById(contentId);
            content.classList.toggle('expanded');
        }

        // ISO 39002 Tool Functions
        function openISO39002Tool() {
            document.getElementById('iso39002ToolModal').style.display = 'flex';
            document.body.style.overflow = 'hidden';
        }

        function closeISO39002Tool() {
            document.getElementById('iso39002ToolModal').style.display = 'none';
            document.body.style.overflow = 'auto';
        }

        function calculateISO39002Risk() {
            const assetType = document.getElementById('toolAssetType').value;
            const probability = document.getElementById('toolProbability').value;
            const severity = parseInt(document.getElementById('toolSeverity').value);
            const distance = parseFloat(document.getElementById('toolDistance').value);

            if (!assetType || !probability || !severity || !distance) {
                showToolResult('toolRiskResult', 'Por favor, completa todos los campos de evaluaci√≥n.');
                return;
            }

            // Matriz de calificaci√≥n ISO 39002
            const riskMatrix = {
                'A': { 1: 1, 2: 3, 3: 6, 4: 10 },
                'B': { 1: 2, 2: 4, 3: 9, 4: 12 },
                'C': { 1: 2, 2: 8, 3: 13, 4: 14 },
                'D': { 1: 7, 2: 11, 3: 15, 4: 16 }
            };

            const riskScore = riskMatrix[probability][severity];
            let riskLevel, riskColor, actions, priority;

            if (riskScore <= 3) {
                riskLevel = 'BAJO';
                riskColor = '#48bb78';
                priority = 'Baja';
                actions = 'Monitoreo rutinario. Inspecciones anuales programadas seg√∫n ISO 39002.';
            } else if (riskScore <= 8) {
                riskLevel = 'MODERADO';
                riskColor = '#ed8936';
                priority = 'Media';
                actions = 'Implementar controles preventivos. Inspecciones semestrales obligatorias.';
            } else if (riskScore <= 12) {
                riskLevel = 'ALTO';
                riskColor = '#e53e3e';
                priority = 'Alta';
                actions = 'Acci√≥n correctiva inmediata. Plan de mitigaci√≥n en 30 d√≠as m√°ximo.';
            } else {
                riskLevel = 'CR√çTICO';
                riskColor = '#c53030';
                priority = 'Cr√≠tica';
                actions = 'Intervenci√≥n urgente. Considerar restricci√≥n de uso hasta mitigaci√≥n completa.';
            }

            const probabilityText = {
                'A': 'Ha o√≠do hablar en la industria',
                'B': 'Ha ocurrido en empresa/industria',
                'C': 'Ha ocurrido en lugar/empresa',
                'D': 'M√°s de una vez al a√±o aqu√≠'
            };

            const severityText = {
                1: 'Lesi√≥n leve, da√±o leve',
                2: 'Lesi√≥n menor, da√±o menor',
                3: 'Lesi√≥n grave, da√±o local',
                4: 'Posible muerte, da√±o extenso'
            };

            const result = `
                <div style="background: rgba(255,255,255,0.95); padding: 25px; border-radius: 16px; border: 3px solid ${riskColor}; text-align: center;">
                    <h4 style="color: ${riskColor}; font-size: 1.8rem; margin-bottom: 15px; font-weight: 700;">üéØ CALIFICACI√ìN DE RIESGO ${riskLevel}</h4>
                    <div style="font-size: 4rem; font-weight: bold; color: ${riskColor}; margin: 20px 0; text-shadow: 0 2px 4px rgba(0,0,0,0.1);">${riskScore}</div>
                    
                    <div style="background: #f7fafc; padding: 20px; border-radius: 12px; margin: 20px 0; text-align: left;">
                        <h5 style="color: #2d3748; margin: 0 0 15px 0;">üìã Evaluaci√≥n ISO 39002:</h5>
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
                            <div>
                                <p style="margin: 0; color: #4a5568; line-height: 1.6;"><strong>Tipo de Activo:</strong> ${assetType}</p>
                                <p style="margin: 5px 0 0 0; color: #4a5568; line-height: 1.6;"><strong>Distancia:</strong> ${distance} km</p>
                                <p style="margin: 5px 0 0 0; color: #4a5568; line-height: 1.6;"><strong>Prioridad:</strong> ${priority}</p>
                            </div>
                            <div>
                                <p style="margin: 0; color: #4a5568; line-height: 1.6;"><strong>Probabilidad:</strong> ${probability} - ${probabilityText[probability]}</p>
                                <p style="margin: 5px 0 0 0; color: #4a5568; line-height: 1.6;"><strong>Severidad:</strong> ${severity} - ${severityText[severity]}</p>
                            </div>
                        </div>
                        <div style="margin-top: 15px; padding: 15px; background: #e6fffa; border-radius: 8px; border-left: 4px solid #4facfe;">
                            <strong style="color: #2d3748;">Acci√≥n Requerida:</strong><br>
                            <span style="color: #4a5568;">${actions}</span>
                        </div>
                    </div>
                    
                    <div style="background: #fff7ed; padding: 20px; border-radius: 12px; margin-top: 20px; text-align: left;">
                        <h5 style="color: #2d3748; margin: 0 0 15px 0;">üìä Matriz de Riesgo ISO 39002</h5>
                        <div style="display: grid; grid-template-columns: repeat(5, 1fr); gap: 5px; font-size: 0.8rem; text-align: center;">
                            <div style="background: #2d3748; color: white; padding: 8px; font-weight: bold;">P/S</div>
                            <div style="background: #2d3748; color: white; padding: 8px; font-weight: bold;">1</div>
                            <div style="background: #2d3748; color: white; padding: 8px; font-weight: bold;">2</div>
                            <div style="background: #2d3748; color: white; padding: 8px; font-weight: bold;">3</div>
                            <div style="background: #2d3748; color: white; padding: 8px; font-weight: bold;">4</div>
                            
                            <div style="background: #2d3748; color: white; padding: 8px; font-weight: bold;">A</div>
                            <div style="background: ${probability === 'A' && severity === 1 ? riskColor : '#48bb78'}; color: white; padding: 8px;">1</div>
                            <div style="background: ${probability === 'A' && severity === 2 ? riskColor : '#ed8936'}; color: white; padding: 8px;">3</div>
                            <div style="background: ${probability === 'A' && severity === 3 ? riskColor : '#ed8936'}; color: white; padding: 8px;">6</div>
                            <div style="background: ${probability === 'A' && severity === 4 ? riskColor : '#e53e3e'}; color: white; padding: 8px;">10</div>
                            
                            <div style="background: #2d3748; color: white; padding: 8px; font-weight: bold;">B</div>
                            <div style="background: ${probability === 'B' && severity === 1 ? riskColor : '#48bb78'}; color: white; padding: 8px;">2</div>
                            <div style="background: ${probability === 'B' && severity === 2 ? riskColor : '#ed8936'}; color: white; padding: 8px;">4</div>
                            <div style="background: ${probability === 'B' && severity === 3 ? riskColor : '#e53e3e'}; color: white; padding: 8px;">9</div>
                            <div style="background: ${probability === 'B' && severity === 4 ? riskColor : '#e53e3e'}; color: white; padding: 8px;">12</div>
                            
                            <div style="background: #2d3748; color: white; padding: 8px; font-weight: bold;">C</div>
                            <div style="background: ${probability === 'C' && severity === 1 ? riskColor : '#48bb78'}; color: white; padding: 8px;">2</div>
                            <div style="background: ${probability === 'C' && severity === 2 ? riskColor : '#ed8936'}; color: white; padding: 8px;">8</div>
                            <div style="background: ${probability === 'C' && severity === 3 ? riskColor : '#c53030'}; color: white; padding: 8px;">13</div>
                            <div style="background: ${probability === 'C' && severity === 4 ? riskColor : '#c53030'}; color: white; padding: 8px;">14</div>
                            
                            <div style="background: #2d3748; color: white; padding: 8px; font-weight: bold;">D</div>
                            <div style="background: ${probability === 'D' && severity === 1 ? riskColor : '#ed8936'}; color: white; padding: 8px;">7</div>
                            <div style="background: ${probability === 'D' && severity === 2 ? riskColor : '#e53e3e'}; color: white; padding: 8px;">11</div>
                            <div style="background: ${probability === 'D' && severity === 3 ? riskColor : '#c53030'}; color: white; padding: 8px;">15</div>
                            <div style="background: ${probability === 'D' && severity === 4 ? riskColor : '#c53030'}; color: white; padding: 8px;">16</div>
                        </div>
                    </div>
                </div>
            `;

            showToolResult('toolRiskResult', result);
            generateInfrastructureRecommendations(riskLevel, assetType, riskScore);
        }

        function generateInfrastructureRecommendations(riskLevel, assetType, riskScore) {
            const recommendations = {
                puente: {
                    BAJO: ['Inspecciones visuales anuales', 'Mantenimiento preventivo de pintura', 'Limpieza de drenajes'],
                    MODERADO: ['Inspecciones estructurales semestrales', 'Monitoreo de fisuras', 'Refuerzo de barandas'],
                    ALTO: ['Evaluaci√≥n estructural detallada', 'Refuerzo de elementos cr√≠ticos', 'Restricci√≥n de carga'],
                    CR√çTICO: ['Cierre temporal para evaluaci√≥n', 'Rehabilitaci√≥n estructural completa', 'Monitoreo continuo']
                },
                tunel: {
                    BAJO: ['Inspecci√≥n de revestimiento', 'Mantenimiento de iluminaci√≥n', 'Limpieza de sistemas de drenaje'],
                    MODERADO: ['Evaluaci√≥n de ventilaci√≥n', 'Inspecci√≥n de sistemas de seguridad', 'Monitoreo de filtraciones'],
                    ALTO: ['Refuerzo del revestimiento', 'Mejora de sistemas de emergencia', 'Restricci√≥n de veh√≠culos pesados'],
                    CR√çTICO: ['Evaluaci√≥n geot√©cnica completa', 'Rehabilitaci√≥n del t√∫nel', 'Sistemas de monitoreo avanzado']
                },
                autopista: {
                    BAJO: ['Mantenimiento de se√±alizaci√≥n', 'Reparaci√≥n de baches menores', 'Limpieza de cunetas'],
                    MODERADO: ['Repavimentaci√≥n parcial', 'Mejora de drenaje', 'Refuerzo de se√±alizaci√≥n'],
                    ALTO: ['Rehabilitaci√≥n de pavimento', 'Mejora de geometr√≠a vial', 'Sistemas de contenci√≥n'],
                    CR√çTICO: ['Reconstrucci√≥n completa', 'Redise√±o geom√©trico', 'Sistemas inteligentes de transporte']
                },
                interseccion: {
                    BAJO: ['Mantenimiento de sem√°foros', 'Repintado de se√±alizaci√≥n horizontal', 'Poda de vegetaci√≥n'],
                    MODERADO: ['Mejora de visibilidad', 'Sincronizaci√≥n semaf√≥rica', 'Se√±alizaci√≥n vertical adicional'],
                    ALTO: ['Redise√±o de la intersecci√≥n', 'Implementaci√≥n de rotonda', 'Sistemas de detecci√≥n'],
                    CR√çTICO: ['Reconstrucci√≥n completa', 'Desnivel o paso a desnivel', 'Control inteligente de tr√°fico']
                }
            };

            const assetRecommendations = recommendations[assetType] || recommendations.autopista;
            const levelRecommendations = assetRecommendations[riskLevel] || ['Evaluaci√≥n especializada requerida'];

            const content = `
                <div style="background: rgba(255,255,255,0.95); padding: 25px; border-radius: 16px;">
                    <h4 style="color: #667eea; margin-bottom: 20px;">üí° Recomendaciones Espec√≠ficas para ${assetType.charAt(0).toUpperCase() + assetType.slice(1)}</h4>
                    
                    <div style="background: #f7fafc; padding: 20px; border-radius: 12px; margin-bottom: 20px;">
                        <h5 style="color: #2d3748; margin: 0 0 15px 0;">üöÄ Acciones Prioritarias:</h5>
                        <div style="display: grid; gap: 12px;">
                            ${levelRecommendations.map((rec, index) => `
                                <div style="background: #ffffff; padding: 15px; border-radius: 8px; border-left: 4px solid #667eea; box-shadow: 0 2px 4px rgba(0,0,0,0.1);">
                                    <strong style="color: #667eea;">Acci√≥n ${index + 1}:</strong> ${rec}
                                </div>
                            `).join('')}
                        </div>
                    </div>
                    
                    <div style="background: #e6fffa; padding: 20px; border-radius: 12px; border-left: 4px solid #4facfe;">
                        <h5 style="color: #2d3748; margin: 0 0 15px 0;">üìä Cronograma Sugerido ISO 39002:</h5>
                        <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 15px;">
                            <div style="text-align: center;">
                                <strong style="color: #4facfe;">Inmediato</strong><br>
                                <span style="font-size: 0.9rem; color: #4a5568;">0-30 d√≠as</span>
                            </div>
                            <div style="text-align: center;">
                                <strong style="color: #4facfe;">Corto Plazo</strong><br>
                                <span style="font-size: 0.9rem; color: #4a5568;">1-6 meses</span>
                            </div>
                            <div style="text-align: center;">
                                <strong style="color: #4facfe;">Mediano Plazo</strong><br>
                                <span style="font-size: 0.9rem; color: #4a5568;">6-24 meses</span>
                            </div>
                        </div>
                    </div>
                    
                    <div style="background: #fff7ed; padding: 20px; border-radius: 12px; margin-top: 20px; border-left: 4px solid #ed8936;">
                        <h5 style="color: #2d3748; margin: 0 0 10px 0;">‚ö†Ô∏è Consideraciones Especiales:</h5>
                        <ul style="margin: 0; padding-left: 20px; color: #4a5568;">
                            <li>Coordinar con autoridades competentes</li>
                            <li>Considerar impacto en el tr√°fico durante intervenciones</li>
                            <li>Establecer protocolos de emergencia durante trabajos</li>
                            <li>Documentar todas las intervenciones para historial del activo</li>
                        </ul>
                    </div>
                </div>
            `;

            document.getElementById('toolRecommendationsContent').innerHTML = content;
            document.getElementById('toolRecommendations').style.display = 'block';
            document.getElementById('toolRecommendations').scrollIntoView({ behavior: 'smooth' });
        }

        function exportInfrastructureReport() {
            const assetType = document.getElementById('toolAssetType').value || 'No especificado';
            const location = document.getElementById('toolLocation').value || 'No especificada';
            const year = document.getElementById('toolConstructionYear').value || 'No especificado';
            const traffic = document.getElementById('toolTrafficVolume').value || 'No especificado';
            const description = document.getElementById('toolAssetDescription').value || 'No especificada';
            
            const timestamp = new Date().toLocaleDateString();
            let report = `REPORTE DE AN√ÅLISIS DE RIESGOS ISO 39002\n`;
            report += `=============================================\n\n`;
            report += `INFORMACI√ìN DEL ACTIVO:\n`;
            report += `- Tipo: ${assetType}\n`;
            report += `- Ubicaci√≥n: ${location}\n`;
            report += `- A√±o de construcci√≥n: ${year}\n`;
            report += `- Tr√°fico diario: ${traffic} veh√≠culos/d√≠a\n`;
            report += `- Descripci√≥n: ${description}\n\n`;
            
            report += `EVALUACI√ìN DE RIESGOS:\n`;
            report += `- Fecha de an√°lisis: ${timestamp}\n`;
            report += `- Metodolog√≠a: ISO 39002:2019\n`;
            report += `- Analista: Sistema de Gesti√≥n de Riesgos Viales\n\n`;
            
            report += `AMENAZAS IDENTIFICADAS:\n`;
            const threats = ['sismo', 'inundacion', 'viento', 'deslizamiento', 'fatiga', 'corrosion', 'sobrecarga', 'desgaste', 'impacto', 'vandalismo', 'mantenimiento', 'uso_inadecuado'];
            threats.forEach(threat => {
                const checkbox = document.getElementById(`threat_${threat}`);
                if (checkbox && checkbox.checked) {
                    report += `- ${checkbox.parentElement.textContent.trim()}\n`;
                }
            });
            
            report += `\nRECOMendaciones implementadas seg√∫n ISO 39002\n`;
            report += `Pr√≥xima revisi√≥n programada en 12 meses\n\n`;
            report += `Generado por: Herramienta de An√°lisis ISO 39002\n`;

            const blob = new Blob([report], { type: 'text/plain' });
            const url = window.URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `analisis_iso39002_${assetType}_${timestamp.replace(/\//g, '-')}.txt`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            window.URL.revokeObjectURL(url);
        }

        function resetInfrastructureTool() {
            // Reset all form fields
            document.getElementById('toolAssetType').value = '';
            document.getElementById('toolConstructionYear').value = '';
            document.getElementById('toolLocation').value = '';
            document.getElementById('toolTrafficVolume').value = '';
            document.getElementById('toolAssetDescription').value = '';
            document.getElementById('toolProbability').value = '';
            document.getElementById('toolSeverity').value = '';
            document.getElementById('toolDistance').value = '';
            
            // Reset checkboxes
            const checkboxes = document.querySelectorAll('#iso39002ToolModal input[type="checkbox"]');
            checkboxes.forEach(checkbox => checkbox.checked = false);
            
            // Hide results
            document.getElementById('toolRiskResult').style.display = 'none';
            document.getElementById('toolRecommendations').style.display = 'none';
            
            // Scroll to top
            document.querySelector('#iso39002ToolModal .modal-container').scrollTo({
                top: 0,
                behavior: 'smooth'
            });
        }

        function showToolResult(elementId, content) {
            const element = document.getElementById(elementId);
            element.innerHTML = content;
            element.style.display = 'block';
            element.scrollIntoView({ behavior: 'smooth' });
        }

        // ISO 39002 Workshop Functions
        function openISO39002Workshop() {
            document.getElementById('iso39002Modal').style.display = 'flex';
            document.body.style.overflow = 'hidden';
        }

        function closeISO39002Workshop() {
            document.getElementById('iso39002Modal').style.display = 'none';
            document.body.style.overflow = 'auto';
        }

        function analyzeAsset() {
            const description = document.getElementById('assetDescription').value;
            const type = document.getElementById('assetType').value;
            
            if (!description || !type) {
                showWorkshopResult('assetAnalysis', 'Por favor, completa la descripci√≥n y tipo de activo.');
                return;
            }

            const analysis = `
                <div style="background: rgba(255,255,255,0.9); padding: 20px; border-radius: 12px; color: #2d3748;">
                    <h6 style="color: #667eea; margin-bottom: 15px;">üîç An√°lisis Autom√°tico del Activo</h6>
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-bottom: 15px;">
                        <div>
                            <strong>üìã Clasificaci√≥n:</strong><br>
                            Activo cr√≠tico de infraestructura vial
                        </div>
                        <div>
                            <strong>‚ö†Ô∏è Nivel de Riesgo Base:</strong><br>
                            ${type === 'puente' ? 'Alto' : type === 'tunel' ? 'Muy Alto' : 'Medio'}
                        </div>
                    </div>
                    <div style="background: #f7fafc; padding: 15px; border-radius: 8px; margin-top: 15px;">
                        <strong>üéØ Factores de Riesgo Identificados:</strong>
                        <ul style="margin: 10px 0 0 20px;">
                            <li>Antig√ºedad y estado de conservaci√≥n</li>
                            <li>Volumen de tr√°fico y tipo de veh√≠culos</li>
                            <li>Condiciones ambientales y clim√°ticas</li>
                            <li>Mantenimiento preventivo y correctivo</li>
                        </ul>
                    </div>
                </div>
            `;

            showWorkshopResult('assetAnalysis', analysis);
        }

        function generateThreatMatrix() {
            const location = document.getElementById('assetLocation').value;
            const age = document.getElementById('assetAge').value;
            const traffic = document.getElementById('trafficLevel').value;
            
            if (!location || !age || !traffic) {
                showWorkshopResult('threatMatrix', 'Por favor, completa todos los campos.');
                return;
            }

            const threats = {
                naturales: ['Sismos', 'Inundaciones', 'Vientos fuertes', 'Deslizamientos'],
                tecnologicas: ['Falla estructural', 'Corrosi√≥n', 'Fatiga de materiales', 'Sobrecarga'],
                humanas: ['Impacto vehicular', 'Vandalismo', 'Mantenimiento deficiente', 'Uso inadecuado']
            };

            const matrix = `
                <div style="background: rgba(255,255,255,0.9); padding: 20px; border-radius: 12px; color: #2d3748;">
                    <h6 style="color: #667eea; margin-bottom: 15px;">‚ö° Matriz de Amenazas Personalizada</h6>
                    
                    <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 15px;">
                        <div style="background: #fff5f5; padding: 15px; border-radius: 8px; border-left: 4px solid #e53e3e;">
                            <h6 style="color: #e53e3e; margin: 0 0 10px 0;">üåç Amenazas Naturales</h6>
                            ${threats.naturales.map(threat => `<div style="padding: 4px 0; font-size: 0.9rem;">‚Ä¢ ${threat}</div>`).join('')}
                        </div>
                        
                        <div style="background: #fffbf0; padding: 15px; border-radius: 8px; border-left: 4px solid #d69e2e;">
                            <h6 style="color: #d69e2e; margin: 0 0 10px 0;">üîß Amenazas Tecnol√≥gicas</h6>
                            ${threats.tecnologicas.map(threat => `<div style="padding: 4px 0; font-size: 0.9rem;">‚Ä¢ ${threat}</div>`).join('')}
                        </div>
                        
                        <div style="background: #f0fff4; padding: 15px; border-radius: 8px; border-left: 4px solid #48bb78;">
                            <h6 style="color: #48bb78; margin: 0 0 10px 0;">üë• Amenazas Humanas</h6>
                            ${threats.humanas.map(threat => `<div style="padding: 4px 0; font-size: 0.9rem;">‚Ä¢ ${threat}</div>`).join('')}
                        </div>
                    </div>
                    
                    <div style="background: #e6fffa; padding: 15px; border-radius: 8px; margin-top: 15px; border-left: 4px solid #4facfe;">
                        <strong>üìä Priorizaci√≥n Autom√°tica:</strong><br>
                        Basado en ubicaci√≥n (${location}), antig√ºedad (${age} a√±os) y tr√°fico (${traffic}), las amenazas de mayor prioridad son:
                        <ol style="margin: 10px 0 0 20px;">
                            <li>Fatiga de materiales (Alta probabilidad)</li>
                            <li>Sobrecarga vehicular (Impacto alto)</li>
                            <li>Condiciones clim√°ticas adversas (Frecuencia alta)</li>
                        </ol>
                    </div>
                </div>
            `;

            showWorkshopResult('threatMatrix', matrix);
        }

        function updateISOCalculation() {
            const probability = parseInt(document.getElementById('probabilityISO').value);
            const impact = parseInt(document.getElementById('impactISO').value);
            const exposure = parseInt(document.getElementById('exposureISO').value);
            
            document.getElementById('probISO').textContent = probability;
            document.getElementById('impactISO').textContent = impact;
            document.getElementById('exposureISO').textContent = exposure;
        }

        function calculateISORisk() {
            const threat = document.getElementById('mainThreat').value;
            const probability = parseInt(document.getElementById('probabilityISO').value);
            const impact = parseInt(document.getElementById('impactISO').value);
            const exposure = parseInt(document.getElementById('exposureISO').value);
            
            if (!threat) {
                showWorkshopResult('isoRiskResult', 'Por favor, selecciona una amenaza principal.');
                return;
            }

            const riskScore = probability * impact * exposure;
            let riskLevel, riskColor, actions;

            if (riskScore <= 27) {
                riskLevel = 'BAJO';
                riskColor = '#48bb78';
                actions = 'Monitoreo rutinario seg√∫n ISO 39002. Revisi√≥n anual de controles.';
            } else if (riskScore <= 64) {
                riskLevel = 'MEDIO';
                riskColor = '#ed8936';
                actions = 'Implementar controles adicionales. Monitoreo trimestral obligatorio.';
            } else if (riskScore <= 100) {
                riskLevel = 'ALTO';
                riskColor = '#e53e3e';
                actions = 'Acci√≥n inmediata requerida. Plan de mitigaci√≥n en 30 d√≠as.';
            } else {
                riskLevel = 'CR√çTICO';
                riskColor = '#c53030';
                actions = 'Intervenci√≥n urgente. Considerar cierre temporal hasta mitigaci√≥n.';
            }

            const result = `
                <div style="background: rgba(255,255,255,0.9); padding: 20px; border-radius: 12px; color: #2d3748; text-align: center;">
                    <h6 style="color: ${riskColor}; font-size: 1.5rem; margin-bottom: 15px;">üìä RIESGO ${riskLevel}</h6>
                    <div style="font-size: 3rem; font-weight: bold; color: ${riskColor}; margin: 15px 0;">${riskScore}</div>
                    
                    <div style="background: #f7fafc; padding: 15px; border-radius: 8px; margin: 15px 0; text-align: left;">
                        <strong>üéØ Acci√≥n Recomendada ISO 39002:</strong><br>
                        ${actions}
                    </div>
                    
                    <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 10px; margin-top: 15px; text-align: center;">
                        <div style="background: #e6fffa; padding: 10px; border-radius: 6px;">
                            <strong>Probabilidad</strong><br>
                            <span style="color: #4facfe; font-size: 1.5rem;">${probability}/5</span>
                        </div>
                        <div style="background: #fff5f5; padding: 10px; border-radius: 6px;">
                            <strong>Impacto</strong><br>
                            <span style="color: #e53e3e; font-size: 1.5rem;">${impact}/5</span>
                        </div>
                        <div style="background: #fffbf0; padding: 10px; border-radius: 6px;">
                            <strong>Exposici√≥n</strong><br>
                            <span style="color: #d69e2e; font-size: 1.5rem;">${exposure}/5</span>
                        </div>
                    </div>
                </div>
            `;

            showWorkshopResult('isoRiskResult', result);
        }

        function generateMitigationPlan() {
            const budget = document.getElementById('mitigationBudget').value;
            const time = document.getElementById('implementationTime').value;
            const strategy = document.getElementById('mitigationStrategy').value;
            
            if (!budget || !time || !strategy) {
                showWorkshopResult('mitigationPlan', 'Por favor, completa todos los campos.');
                return;
            }

            const plans = {
                evitar: {
                    bajo: ['Se√±alizaci√≥n de restricci√≥n', 'Desv√≠o temporal', 'Limitaci√≥n de carga'],
                    medio: ['Refuerzo estructural b√°sico', 'Sistema de monitoreo', 'Protocolos de emergencia'],
                    alto: ['Redise√±o completo', 'Tecnolog√≠a avanzada', 'Sistema automatizado']
                },
                reducir: {
                    bajo: ['Mantenimiento preventivo', 'Inspecciones regulares', 'Capacitaci√≥n personal'],
                    medio: ['Sistemas de alerta temprana', 'Mejoras estructurales', 'Monitoreo continuo'],
                    alto: ['Rehabilitaci√≥n integral', 'Tecnolog√≠a predictiva', 'Centro de control']
                },
                transferir: {
                    bajo: ['Seguro b√°sico', 'Contratos de mantenimiento', 'Garant√≠as extendidas'],
                    medio: ['Seguro integral', 'Outsourcing especializado', 'Fondos de contingencia'],
                    alto: ['Concesi√≥n privada', 'Seguros param√©tricos', 'Bonos catastr√≥ficos']
                },
                aceptar: {
                    bajo: ['Plan de contingencia', 'Monitoreo b√°sico', 'Reservas financieras'],
                    medio: ['Sistema de respuesta', 'Monitoreo avanzado', 'Seguros complementarios'],
                    alto: ['Centro de crisis', 'Tecnolog√≠a predictiva', 'Fondos especializados']
                }
            };

            const selectedActions = plans[strategy][budget] || ['Plan personalizado requerido'];
            
            const plan = `
                <div style="background: rgba(255,255,255,0.9); padding: 20px; border-radius: 12px; color: #2d3748;">
                    <h6 style="color: #667eea; margin-bottom: 15px;">üìã Plan de Tratamiento ISO 39002</h6>
                    
                    <div style="background: #f7fafc; padding: 15px; border-radius: 8px; margin-bottom: 15px;">
                        <strong>Estrategia:</strong> ${strategy.charAt(0).toUpperCase() + strategy.slice(1)} el riesgo<br>
                        <strong>Presupuesto:</strong> ${budget.charAt(0).toUpperCase() + budget.slice(1)}<br>
                        <strong>Plazo:</strong> ${time.replace('_', ' ')}
                    </div>
                    
                    <h6 style="color: #48bb78; margin: 15px 0 10px 0;">üöÄ Acciones Espec√≠ficas:</h6>
                    <div style="display: grid; gap: 10px;">
                        ${selectedActions.map((action, index) => `
                            <div style="background: #f0fff4; padding: 12px; border-radius: 8px; border-left: 4px solid #48bb78;">
                                <strong>Fase ${index + 1}:</strong> ${action}
                                <div style="margin-top: 5px; font-size: 0.9rem; color: #4a5568;">
                                    ‚è±Ô∏è Tiempo estimado: ${2 + index * 2}-${4 + index * 3} semanas
                                </div>
                            </div>
                        `).join('')}
                    </div>
                    
                    <div style="background: #e6fffa; padding: 15px; border-radius: 8px; margin-top: 15px; border-left: 4px solid #4facfe;">
                        <strong>üìà Indicadores de √âxito (KPIs):</strong>
                        <ul style="margin: 10px 0 0 20px;">
                            <li>Reducci√≥n del nivel de riesgo en 50%</li>
                            <li>Cumplimiento de cronograma de implementaci√≥n</li>
                            <li>Eficiencia en uso del presupuesto asignado</li>
                            <li>Mejora en indicadores de resiliencia</li>
                        </ul>
                    </div>
                </div>
            `;

            showWorkshopResult('mitigationPlan', plan);
        }

        function generateMonitoringPlan() {
            const frequency = document.getElementById('monitoringFrequency').value;
            const kpis = [];
            
            if (document.getElementById('kpi1').checked) kpis.push('Estado estructural');
            if (document.getElementById('kpi2').checked) kpis.push('Volumen de tr√°fico');
            if (document.getElementById('kpi3').checked) kpis.push('Condiciones clim√°ticas');
            if (document.getElementById('kpi4').checked) kpis.push('Incidentes de seguridad');
            
            if (!frequency || kpis.length === 0) {
                showWorkshopResult('monitoringPlan', 'Por favor, selecciona la frecuencia y al menos un indicador.');
                return;
            }

            const plan = `
                <div style="background: rgba(255,255,255,0.9); padding: 20px; border-radius: 12px; color: #2d3748;">
                    <h6 style="color: #667eea; margin-bottom: 15px;">üìä Sistema de Monitoreo Inteligente</h6>
                    
                    <div style="background: #f7fafc; padding: 15px; border-radius: 8px; margin-bottom: 15px;">
                        <strong>üìÖ Frecuencia:</strong> ${frequency.charAt(0).toUpperCase() + frequency.slice(1)}<br>
                        <strong>üìà KPIs Seleccionados:</strong> ${kpis.length} indicadores
                    </div>
                    
                    <h6 style="color: #48bb78; margin: 15px 0 10px 0;">üéØ Indicadores a Monitorear:</h6>
                    <div style="display: grid; gap: 10px;">
                        ${kpis.map(kpi => `
                            <div style="background: #f0fff4; padding: 12px; border-radius: 8px; border-left: 4px solid #48bb78;">
                                <strong>üìä ${kpi}</strong>
                                <div style="margin-top: 5px; font-size: 0.9rem; color: #4a5568;">
                                    Monitoreo ${frequency} con alertas autom√°ticas
                                </div>
                            </div>
                        `).join('')}
                    </div>
                    
                    <div style="background: #fff7ed; padding: 15px; border-radius: 8px; margin-top: 15px; border-left: 4px solid #ed8936;">
                        <strong>ü§ñ Tecnolog√≠as Recomendadas:</strong>
                        <ul style="margin: 10px 0 0 20px;">
                            <li>Sensores IoT para monitoreo estructural</li>
                            <li>C√°maras inteligentes con IA para tr√°fico</li>
                            <li>Estaciones meteorol√≥gicas autom√°ticas</li>
                            <li>Dashboard en tiempo real con alertas</li>
                        </ul>
                    </div>
                    
                    <div style="background: #e6fffa; padding: 15px; border-radius: 8px; margin-top: 15px; border-left: 4px solid #4facfe;">
                        <strong>üìã Plan de Respuesta Autom√°tica:</strong><br>
                        ‚Ä¢ Alertas inmediatas cuando se superen umbrales<br>
                        ‚Ä¢ Activaci√≥n autom√°tica de protocolos de emergencia<br>
                        ‚Ä¢ Notificaci√≥n a equipos de respuesta especializados<br>
                        ‚Ä¢ Registro autom√°tico para an√°lisis de tendencias
                    </div>
                </div>
            `;

            showWorkshopResult('monitoringPlan', plan);
        }

        function exportISO39002Report() {
            const timestamp = new Date().toLocaleDateString();
            let report = `REPORTE ISO 39002 - GESTI√ìN DE RIESGOS EN INFRAESTRUCTURA VIAL\n`;
            report += `================================================================\n\n`;
            report += `Fecha de generaci√≥n: ${timestamp}\n`;
            report += `Metodolog√≠a aplicada: ISO 39002:2019\n\n`;
            
            report += `RESUMEN EJECUTIVO:\n`;
            report += `- Evaluaci√≥n sistem√°tica de riesgos completada\n`;
            report += `- Plan de tratamiento desarrollado\n`;
            report += `- Sistema de monitoreo definido\n`;
            report += `- Cumplimiento con est√°ndares internacionales\n\n`;
            
            report += `PR√ìXIMOS PASOS:\n`;
            report += `1. Validaci√≥n t√©cnica del an√°lisis\n`;
            report += `2. Aprobaci√≥n de presupuesto para implementaci√≥n\n`;
            report += `3. Inicio de fase piloto de monitoreo\n`;
            report += `4. Revisi√≥n trimestral de indicadores\n\n`;
            
            report += `Generado por: Taller Pr√°ctico ISO 39002 con IA\n`;
            report += `Plataforma: Sistema de Gesti√≥n de Riesgos Viales\n`;

            // Create and download file
            const blob = new Blob([report], { type: 'text/plain' });
            const url = window.URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `reporte_iso39002_${timestamp.replace(/\//g, '-')}.txt`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            window.URL.revokeObjectURL(url);
        }

        function showWorkshopResult(elementId, content) {
            const element = document.getElementById(elementId);
            element.innerHTML = content;
            element.style.display = 'block';
            element.scrollIntoView({ behavior: 'smooth' });
        }

        // Bowtie App Functions
        function openBowtieApp() {
            document.getElementById('bowtieAppModal').style.display = 'flex';
            document.body.style.overflow = 'hidden';
        }

        function closeBowtieApp() {
            document.getElementById('bowtieAppModal').style.display = 'none';
            document.body.style.overflow = 'auto';
        }

        function generateBowtieVisualization() {
            const centralEvent = document.getElementById('centralEvent').value || 'Evento no especificado';
            const location = document.getElementById('eventLocation').value || 'Ubicaci√≥n no especificada';
            
            const threats = [
                'Velocidad excesiva para las condiciones',
                'Condiciones clim√°ticas adversas',
                'Falla del sistema de frenos',
                'Fatiga del conductor',
                'Se√±alizaci√≥n deficiente',
                'Pavimento en mal estado'
            ];
            
            const consequences = [
                'Lesiones graves o muertes',
                'Da√±os materiales significativos',
                'Interrupci√≥n del tr√°fico',
                'Costos legales y seguros',
                'Impacto en reputaci√≥n',
                'P√©rdidas econ√≥micas'
            ];
            
            const preventiveBarriers = [
                'Controles de velocidad',
                'Mantenimiento preventivo',
                'Capacitaci√≥n del personal',
                'Inspecciones regulares',
                'Mejoras en se√±alizaci√≥n',
                'Sistemas de alerta'
            ];
            
            const mitigationBarriers = [
                'Servicios de emergencia',
                'Sistemas de seguridad',
                'Protocolos de respuesta',
                'Seguros adecuados',
                'Planes de contingencia',
                'Comunicaci√≥n de crisis'
            ];
            
            const visualization = `
                <div style="background: #f7fafc; padding: 20px; border-radius: 12px; margin-bottom: 20px;">
                    <h4 style="color: #2d3748; margin-bottom: 10px;">üìç Informaci√≥n del An√°lisis</h4>
                    <p><strong>Evento Central:</strong> ${centralEvent}</p>
                    <p><strong>Ubicaci√≥n:</strong> ${location}</p>
                    <p><strong>Fecha de An√°lisis:</strong> ${new Date().toLocaleDateString()}</p>
                </div>
                
                <div style="display: grid; grid-template-columns: 1fr 150px 1fr; gap: 20px; align-items: center; margin: 40px 0;">
                    <div>
                        <h4 style="text-align: center; color: #e53e3e; font-weight: 700; margin-bottom: 20px;">üö® AMENAZAS</h4>
                        ${threats.map(threat => `<div style="background: #fed7d7; padding: 12px; border-radius: 8px; margin-bottom: 10px; border-left: 4px solid #e53e3e; font-size: 0.9rem;">${threat}</div>`).join('')}
                    </div>
                    
                    <div style="background: linear-gradient(135deg, #e53e3e, #c53030); color: white; padding: 20px; border-radius: 15px; text-align: center; font-weight: 700; position: relative;">
                        üí•<br>
                        ${centralEvent.toUpperCase()}
                    </div>
                    
                    <div>
                        <h4 style="text-align: center; color: #d69e2e; font-weight: 700; margin-bottom: 20px;">‚ö†Ô∏è CONSECUENCIAS</h4>
                        ${consequences.map(consequence => `<div style="background: #faf089; padding: 12px; border-radius: 8px; margin-bottom: 10px; border-left: 4px solid #d69e2e; font-size: 0.9rem; color: #2d3436;">${consequence}</div>`).join('')}
                    </div>
                </div>
                
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 30px; margin-top: 40px;">
                    <div style="background: linear-gradient(135deg, #48bb78, #38a169); color: white; padding: 25px; border-radius: 16px;">
                        <h4 style="text-align: center; margin-bottom: 15px;">üõ°Ô∏è BARRERAS PREVENTIVAS</h4>
                        ${preventiveBarriers.map(barrier => `<div style="background: rgba(255,255,255,0.2); padding: 10px; border-radius: 8px; margin-bottom: 8px; font-size: 0.9rem;">${barrier}</div>`).join('')}
                    </div>
                    
                    <div style="background: linear-gradient(135deg, #48bb78, #38a169); color: white; padding: 25px; border-radius: 16px;">
                        <h4 style="text-align: center; margin-bottom: 15px;">üöë BARRERAS DE MITIGACI√ìN</h4>
                        ${mitigationBarriers.map(barrier => `<div style="background: rgba(255,255,255,0.2); padding: 10px; border-radius: 8px; margin-bottom: 8px; font-size: 0.9rem;">${barrier}</div>`).join('')}
                    </div>
                </div>
            `;
            
            document.getElementById('generatedBowtieDisplay').innerHTML = visualization;
            document.getElementById('bowtieVisualization').style.display = 'block';
            document.getElementById('bowtieVisualization').scrollIntoView({ behavior: 'smooth' });
        }

        function exportBowtie() {
            const centralEvent = document.getElementById('centralEvent').value || 'Evento no especificado';
            const location = document.getElementById('eventLocation').value || 'Ubicaci√≥n no especificada';
            
            let exportData = `AN√ÅLISIS DEL CORBAT√çN (BOWTIE ANALYSIS)\n`;
            exportData += `==========================================\n\n`;
            exportData += `Evento Central: ${centralEvent}\n`;
            exportData += `Ubicaci√≥n: ${location}\n`;
            exportData += `Fecha: ${new Date().toLocaleDateString()}\n\n`;
            exportData += `An√°lisis generado por: Sistema de Gesti√≥n de Riesgos Viales\n`;
            
            const blob = new Blob([exportData], { type: 'text/plain' });
            const url = window.URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `analisis_corbatin_${centralEvent.replace(/\s+/g, '_').toLowerCase()}.txt`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            window.URL.revokeObjectURL(url);
        }

        // Initialize on page load
        document.addEventListener('DOMContentLoaded', function() {
            updateNavigation(1);
        });
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'99594ceaa332b6f2',t:'MTc2MTY0MjYzMS4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
